2021-12-09 17:16:05.314507: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3800000000 Hz
2021-12-09 17:16:05.315606: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561c96f92ee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-12-09 17:16:05.315624: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-12-09 17:16:05.324486: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-12-09 17:16:05.981325: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561c96f579d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-12-09 17:16:05.981355: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 SUPER, Compute Capability 7.5
2021-12-09 17:16:05.981695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 17:16:05.983089: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 17:16:05.990347: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 17:16:05.998190: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 17:16:06.017233: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 17:16:06.025105: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 17:16:06.033544: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 17:16:06.043213: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 17:16:06.043597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 17:16:06.043634: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 17:16:06.043862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-09 17:16:06.043871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-09 17:16:06.043879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-09 17:16:06.044219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7472 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)

Model: batmen
test set detect: uk
test set classif: Natagora
Generate training positions
Train classifier
Compute or load features
^[[D    ^[[D    ^[[D    Tune cls_cnn

 tune cnn
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:00<?, ?trial/s, best loss=?]                                                                                                                        CNN params= 
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:17<?, ?trial/s, best loss=?]                                                                                                                        {'nb_conv_layers': 3, 'nb_dense_layers': 4, 'nb_filters': 32, 'filter_size': 4, 'pool_size': 2, 'nb_dense_nodes': 384, 'dropout_proba': 0.3, 'learn_rate_adam': 0.0013894954943731374, 'beta_1': 0.9, 'beta_2': 0.95, 'epsilon': 1e-08, 'min_delta': 0.005, 'patience': 10, 'batchsize': 384}
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:17<?, ?trial/s, best loss=?]2021-12-09 17:20:46.907834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 17:20:46.935254: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 17:20:46.935348: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 17:20:46.935379: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 17:20:46.935406: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 17:20:46.935429: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 17:20:46.935437: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 17:20:46.935445: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 17:20:46.935818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 17:20:46.936521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 17:20:46.936552: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 17:20:46.936561: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 17:20:46.936571: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 17:20:46.936582: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 17:20:46.936594: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 17:20:46.936603: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 17:20:46.936611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 17:20:46.936869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 17:20:46.936894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-09 17:20:46.936899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-09 17:20:46.936903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-09 17:20:46.937184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7472 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)
                                                                                                                        Model: "sequential"
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Layer (type)                 Output Shape              Param #   
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d (QuantConv2D)   (None, 130, 20, 32)       544       
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d (MaxPooling2D) (None, 65, 10, 32)        0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_1 (QuantConv2D) (None, 65, 10, 32)        16416     
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_1 (MaxPooling2 (None, 32, 5, 32)         0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_2 (QuantConv2D) (None, 32, 5, 32)         16416     
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_2 (MaxPooling2 (None, 16, 2, 32)         0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_3 (QuantConv2D) (None, 16, 2, 32)         16416     
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_3 (MaxPooling2 (None, 8, 1, 32)          0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout (Dropout)            (None, 8, 1, 32)          0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        flatten (Flatten)            (None, 256)               0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense (QuantDense)     (None, 384)               98688     
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout_1 (Dropout)          (None, 384)               0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_1 (QuantDense)   (None, 384)               147840    
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout_2 (Dropout)          (None, 384)               0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_2 (QuantDense)   (None, 384)               147840    
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout_3 (Dropout)          (None, 384)               0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_3 (QuantDense)   (None, 384)               147840    
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout_4 (Dropout)          (None, 384)               0         
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_4 (QuantDense)   (None, 8)                 3080      
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Total params: 595,080
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Trainable params: 595,080
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Non-trainable params: 0
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]/home/ndewinter/.local/lib/python3.6/site-packages/sklearn/utils/validation.py:72: FutureWarning: Pass classes=[0 1 2 3 4 5 6 7], y=[7 7 7 ... 3 3 3] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  "will result in an error", FutureWarning)

                                                                                                                        Fit the CNN
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:18<?, ?trial/s, best loss=?]2021-12-09 17:20:47.929154: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2909088000 exceeds 10% of free system memory.
2021-12-09 17:20:49.203562: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 323232000 exceeds 10% of free system memory.
                                                                                                                        Train on 279720 samples, validate on 31080 samples
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:19<?, ?trial/s, best loss=?]                                                                                                                        Epoch 1/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:19<?, ?trial/s, best loss=?]2021-12-09 17:20:50.273171: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 17:20:50.467146: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 17:20:52.081638: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 4.00G (4294967296 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
                                                                                                                        279720/279720 - 15s - loss: 10.6413 - accuracy: 0.3287 - sparse_categorical_accuracy: 0.3287 - val_loss: 6.8808 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:34<?, ?trial/s, best loss=?]                                                                                                                        Epoch 2/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:34<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 8.0456 - accuracy: 0.3338 - sparse_categorical_accuracy: 0.3338 - val_loss: 23.6022 - val_accuracy: 0.0456 - val_sparse_categorical_accuracy: 0.0456

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:46<?, ?trial/s, best loss=?]                                                                                                                        Epoch 3/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:46<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 7.8690 - accuracy: 0.3348 - sparse_categorical_accuracy: 0.3348 - val_loss: 5.9284 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:57<?, ?trial/s, best loss=?]                                                                                                                        Epoch 4/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [00:57<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 7.2909 - accuracy: 0.3363 - sparse_categorical_accuracy: 0.3363 - val_loss: 1.7573 - val_accuracy: 0.5000 - val_sparse_categorical_accuracy: 0.5000

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:09<?, ?trial/s, best loss=?]                                                                                                                        Epoch 5/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:09<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 7.2229 - accuracy: 0.3356 - sparse_categorical_accuracy: 0.3356 - val_loss: 6.7048 - val_accuracy: 0.0631 - val_sparse_categorical_accuracy: 0.0631

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:21<?, ?trial/s, best loss=?]                                                                                                                        Epoch 6/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:21<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 7.2399 - accuracy: 0.3335 - sparse_categorical_accuracy: 0.3335 - val_loss: 2.3685 - val_accuracy: 0.5000 - val_sparse_categorical_accuracy: 0.5000

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:32<?, ?trial/s, best loss=?]                                                                                                                        Epoch 7/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:32<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 7.0673 - accuracy: 0.3266 - sparse_categorical_accuracy: 0.3266 - val_loss: 4.5892 - val_accuracy: 0.5000 - val_sparse_categorical_accuracy: 0.5000

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:44<?, ?trial/s, best loss=?]                                                                                                                        Epoch 8/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:44<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 6.9458 - accuracy: 0.3347 - sparse_categorical_accuracy: 0.3347 - val_loss: 5.5777 - val_accuracy: 0.5000 - val_sparse_categorical_accuracy: 0.5000

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:55<?, ?trial/s, best loss=?]                                                                                                                        Epoch 9/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [01:55<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 6.8650 - accuracy: 0.3365 - sparse_categorical_accuracy: 0.3365 - val_loss: 6.6351 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:07<?, ?trial/s, best loss=?]                                                                                                                        Epoch 10/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:07<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 6.7244 - accuracy: 0.3356 - sparse_categorical_accuracy: 0.3356 - val_loss: 3.6916 - val_accuracy: 0.3425 - val_sparse_categorical_accuracy: 0.3425

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:19<?, ?trial/s, best loss=?]                                                                                                                        Epoch 11/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:19<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 6.6597 - accuracy: 0.3295 - sparse_categorical_accuracy: 0.3295 - val_loss: 11.4561 - val_accuracy: 0.0456 - val_sparse_categorical_accuracy: 0.0456

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:30<?, ?trial/s, best loss=?]                                                                                                                        Epoch 12/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:30<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 6.4659 - accuracy: 0.3397 - sparse_categorical_accuracy: 0.3397 - val_loss: 5.2321 - val_accuracy: 0.5000 - val_sparse_categorical_accuracy: 0.5000

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:42<?, ?trial/s, best loss=?]                                                                                                                        Epoch 13/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:42<?, ?trial/s, best loss=?]^[[A                                                                                                                        279720/279720 - 12s - loss: 6.4182 - accuracy: 0.3393 - sparse_categorical_accuracy: 0.3393 - val_loss: 6.6225 - val_accuracy: 0.0631 - val_sparse_categorical_accuracy: 0.0631

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:53<?, ?trial/s, best loss=?]                                                                                                                        Epoch 14/200
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [02:53<?, ?trial/s, best loss=?]                                                                                                                        Restoring model weights from the end of the best epoch.
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [03:05<?, ?trial/s, best loss=?]                                                                                                                        279720/279720 - 12s - loss: 6.3438 - accuracy: 0.3395 - sparse_categorical_accuracy: 0.3395 - val_loss: 4.2888 - val_accuracy: 0.0456 - val_sparse_categorical_accuracy: 0.0456

 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [03:05<?, ?trial/s, best loss=?]                                                                                                                        Epoch 00014: early stopping
 91%|████████████████████████████████████████████████████████████████████▏      | 10/11 [03:05<?, ?trial/s, best loss=?]100%|████████████████████████████████████████████████| 11/11 [03:05<00:00, 185.39s/trial, best loss: 0.7151261377825546]100%|████████████████████████████████████████████████| 11/11 [03:05<00:00, 185.40s/trial, best loss: 0.7151261377825546]
best_space= {'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'pool_size': 2, 'patience': 20, 'min_delta': 0.005, 'batchsize': 320, 'filter_size': 3, 'nb_dense_layers': 2, 'nb_output': 8, 'beta_2': 0.999, 'epsilon': 1e-08, 'nb_conv_layers': 3, 'nb_filters': 48, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8}
total tuning time 185.412 (secs) = 3.09 min \\
Fit cls_cnn
CNN params=  {'nb_conv_layers': 3, 'nb_dense_layers': 2, 'nb_filters': 48, 'filter_size': 3, 'pool_size': 2, 'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8, 'beta_2': 0.999, 'epsilon': 1e-08, 'min_delta': 0.005, 'patience': 20, 'batchsize': 320}
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
quant_conv2d (QuantConv2D)   (None, 130, 20, 48)       480       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 65, 10, 48)        0         
_________________________________________________________________
quant_conv2d_1 (QuantConv2D) (None, 65, 10, 48)        20784     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 32, 5, 48)         0         
_________________________________________________________________
quant_conv2d_2 (QuantConv2D) (None, 32, 5, 48)         20784     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 16, 2, 48)         0         
_________________________________________________________________
quant_conv2d_3 (QuantConv2D) (None, 16, 2, 48)         20784     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 8, 1, 48)          0         
_________________________________________________________________
dropout (Dropout)            (None, 8, 1, 48)          0         
_________________________________________________________________
flatten (Flatten)            (None, 384)               0         
_________________________________________________________________
quant_dense (QuantDense)     (None, 192)               73920     
_________________________________________________________________
dropout_1 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_1 (QuantDense)   (None, 192)               37056     
_________________________________________________________________
dropout_2 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_2 (QuantDense)   (None, 8)                 1544      
=================================================================
Total params: 175,352
Trainable params: 175,352
Non-trainable params: 0
_________________________________________________________________
Fit the CNN
2021-12-09 17:23:35.527178: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2909088000 exceeds 10% of free system memory.
2021-12-09 17:23:36.743421: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 323232000 exceeds 10% of free system memory.
Train on 279720 samples, validate on 31080 samples
Epoch 1/200
2021-12-09 17:23:37.885011: W tensorflow/core/common_runtime/bfc_allocator.cc:311] Garbage collection: deallocate free memory regions (i.e., allocations) so that we can re-allocate a larger region to avoid OOM due to memory fragmentation. If you see this message frequently, you are running near the threshold of the available device memory and re-allocation may incur great performance overhead. You may try smaller batch sizes to observe the performance impact. Set TF_ENABLE_GPU_GARBAGE_COLLECTION=false if you'd like to disable this feature.
279720/279720 - 15s - loss: 11.6054 - accuracy: 0.3052 - sparse_categorical_accuracy: 0.3052 - val_loss: 10.1665 - val_accuracy: 0.2366 - val_sparse_categorical_accuracy: 0.2366
Epoch 2/200
279720/279720 - 14s - loss: 9.8366 - accuracy: 0.3271 - sparse_categorical_accuracy: 0.3271 - val_loss: 7.3733 - val_accuracy: 0.2533 - val_sparse_categorical_accuracy: 0.2533
Epoch 3/200
279720/279720 - 14s - loss: 8.5184 - accuracy: 0.3295 - sparse_categorical_accuracy: 0.3295 - val_loss: 14.0744 - val_accuracy: 0.0682 - val_sparse_categorical_accuracy: 0.0682
Epoch 4/200
279720/279720 - 14s - loss: 8.1090 - accuracy: 0.3329 - sparse_categorical_accuracy: 0.3329 - val_loss: 13.3588 - val_accuracy: 0.0244 - val_sparse_categorical_accuracy: 0.0244
Epoch 5/200
^[[A     279720/279720 - 14s - loss: 6.8718 - accuracy: 0.3362 - sparse_categorical_accuracy: 0.3362 - val_loss: 4.2761 - val_accuracy: 0.2801 - val_sparse_categorical_accuracy: 0.2801
Epoch 6/200
279720/279720 - 14s - loss: 5.7511 - accuracy: 0.3392 - sparse_categorical_accuracy: 0.3392 - val_loss: 3.4326 - val_accuracy: 0.3844 - val_sparse_categorical_accuracy: 0.3844
Epoch 7/200
279720/279720 - 14s - loss: 5.2077 - accuracy: 0.3462 - sparse_categorical_accuracy: 0.3462 - val_loss: 4.1833 - val_accuracy: 0.3287 - val_sparse_categorical_accuracy: 0.3287
Epoch 8/200
279720/279720 - 14s - loss: 4.9267 - accuracy: 0.3469 - sparse_categorical_accuracy: 0.3469 - val_loss: 2.0354 - val_accuracy: 0.4820 - val_sparse_categorical_accuracy: 0.4820
Epoch 9/200
279720/279720 - 14s - loss: 4.4617 - accuracy: 0.3522 - sparse_categorical_accuracy: 0.3522 - val_loss: 2.5360 - val_accuracy: 0.4492 - val_sparse_categorical_accuracy: 0.4492
Epoch 10/200
279720/279720 - 14s - loss: 4.5342 - accuracy: 0.3536 - sparse_categorical_accuracy: 0.3536 - val_loss: 6.2109 - val_accuracy: 0.0530 - val_sparse_categorical_accuracy: 0.0530
Epoch 11/200
279720/279720 - 14s - loss: 4.5712 - accuracy: 0.3524 - sparse_categorical_accuracy: 0.3524 - val_loss: 3.1891 - val_accuracy: 0.4289 - val_sparse_categorical_accuracy: 0.4289
Epoch 12/200
279720/279720 - 14s - loss: 4.2711 - accuracy: 0.3596 - sparse_categorical_accuracy: 0.3596 - val_loss: 3.0649 - val_accuracy: 0.4140 - val_sparse_categorical_accuracy: 0.4140
Epoch 13/200
279720/279720 - 14s - loss: 4.1118 - accuracy: 0.3612 - sparse_categorical_accuracy: 0.3612 - val_loss: 8.8398 - val_accuracy: 0.4997 - val_sparse_categorical_accuracy: 0.4997
Epoch 14/200
279720/279720 - 14s - loss: 4.0698 - accuracy: 0.3607 - sparse_categorical_accuracy: 0.3607 - val_loss: 2.6202 - val_accuracy: 0.4847 - val_sparse_categorical_accuracy: 0.4847
Epoch 15/200
279720/279720 - 14s - loss: 3.7475 - accuracy: 0.3690 - sparse_categorical_accuracy: 0.3690 - val_loss: 7.4383 - val_accuracy: 0.0101 - val_sparse_categorical_accuracy: 0.0101
Epoch 16/200
279720/279720 - 14s - loss: 3.4775 - accuracy: 0.3734 - sparse_categorical_accuracy: 0.3734 - val_loss: 2.3019 - val_accuracy: 0.4987 - val_sparse_categorical_accuracy: 0.4987
Epoch 17/200
279720/279720 - 14s - loss: 3.4054 - accuracy: 0.3768 - sparse_categorical_accuracy: 0.3768 - val_loss: 5.0932 - val_accuracy: 0.5000 - val_sparse_categorical_accuracy: 0.5000
Epoch 18/200
^[[D    279720/279720 - 14s - loss: 3.4453 - accuracy: 0.3753 - sparse_categorical_accuracy: 0.3753 - val_loss: 2.4653 - val_accuracy: 0.4595 - val_sparse_categorical_accuracy: 0.4595
Epoch 19/200
279720/279720 - 14s - loss: 3.4937 - accuracy: 0.3736 - sparse_categorical_accuracy: 0.3736 - val_loss: 2.9444 - val_accuracy: 0.1601 - val_sparse_categorical_accuracy: 0.1601
Epoch 20/200
279720/279720 - 14s - loss: 3.4839 - accuracy: 0.3768 - sparse_categorical_accuracy: 0.3768 - val_loss: 5.1722 - val_accuracy: 0.0344 - val_sparse_categorical_accuracy: 0.0344
Epoch 21/200
279720/279720 - 14s - loss: 3.7161 - accuracy: 0.3697 - sparse_categorical_accuracy: 0.3697 - val_loss: 3.1882 - val_accuracy: 0.4984 - val_sparse_categorical_accuracy: 0.4984
Epoch 22/200
279720/279720 - 14s - loss: 3.8976 - accuracy: 0.3663 - sparse_categorical_accuracy: 0.3663 - val_loss: 7.7095 - val_accuracy: 0.0456 - val_sparse_categorical_accuracy: 0.0456
Epoch 23/200
279720/279720 - 14s - loss: 3.9821 - accuracy: 0.3659 - sparse_categorical_accuracy: 0.3659 - val_loss: 3.4941 - val_accuracy: 0.0269 - val_sparse_categorical_accuracy: 0.0269
Epoch 24/200
279720/279720 - 14s - loss: 3.9809 - accuracy: 0.3615 - sparse_categorical_accuracy: 0.3615 - val_loss: 3.5541 - val_accuracy: 0.4915 - val_sparse_categorical_accuracy: 0.4915
Epoch 25/200
279720/279720 - 14s - loss: 3.9011 - accuracy: 0.3615 - sparse_categorical_accuracy: 0.3615 - val_loss: 5.0515 - val_accuracy: 0.4913 - val_sparse_categorical_accuracy: 0.4913
Epoch 26/200
279720/279720 - 14s - loss: 3.6788 - accuracy: 0.3663 - sparse_categorical_accuracy: 0.3663 - val_loss: 2.7824 - val_accuracy: 0.3084 - val_sparse_categorical_accuracy: 0.3084
Epoch 27/200
279720/279720 - 14s - loss: 3.7279 - accuracy: 0.3658 - sparse_categorical_accuracy: 0.3658 - val_loss: 2.3549 - val_accuracy: 0.2576 - val_sparse_categorical_accuracy: 0.2576
Epoch 28/200
Restoring model weights from the end of the best epoch.
279720/279720 - 14s - loss: 3.4897 - accuracy: 0.3729 - sparse_categorical_accuracy: 0.3729 - val_loss: 3.2156 - val_accuracy: 0.4996 - val_sparse_categorical_accuracy: 0.4996
Epoch 00028: early stopping

hard negative mining
	hmn round 0
09\_12\_21\_17\_16\_06\_classif\_batmen\_hnm0
2021-12-09 17:30:05.159625: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /usr/local/lib64/python3.6/site-packages/tensorflow/python/ops/resource_variable_ops.py:1809: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
mod_params= {'nb_conv_layers': 3, 'nb_dense_layers': 2, 'nb_filters': 48, 'filter_size': 3, 'pool_size': 2, 'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8, 'beta_2': 0.999, 'epsilon': 1e-08, 'min_delta': 0.005, 'patience': 20, 'batchsize': 320, 'win_size': 0.23, 'chunk_size': 0, 'max_freq': 270, 'min_freq': 10, 'mean_log_mag': 0.5, 'slice_scale': 0.02322, 'overlap': 0.75, 'crop_spec': True, 'denoise': True, 'smooth_spec': True, 'nms_win_size': 21, 'smooth_op_prediction_sigma': 1.0335917312661498, 'num_hnm': 2}
--------------
Confusion matrix detect + classif
--------------
[[1273402       0   18662       0       0       2       0       0]
 [     50       0      59       0       0       0       0       0]
 [    798       0     947       0       0       0       0       0]
 [    841       0    1332       0       0       0       0       0]
 [    190       0     298       0       0       0       0       0]
 [    361       0     537       0       0       0       0       0]
 [     73       0      99       0       0       0       0       0]
 [    169       0     234       0       0       0       0       0]]
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:206: RuntimeWarning: invalid value encountered in true_divide
  PRE = TP/(TP+FP).astype(float)
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:208: RuntimeWarning: invalid value encountered in true_divide
  F1 = 2*(PRE*REC)/(PRE+REC)
--------------
Class 0 detect + classif
--------------
Accuracy 0.9837094604692871
Precision 0.9980546820870863
Recall 0.985554917473256
F1 0.991765415993302
BCR 0.785529629745312

--------------
Class 1 detect + classif
--------------
Accuracy 0.9999160281467488
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 2 detect + classif
--------------
Accuracy 0.9830369152593036
Precision 0.0427192349332371
Recall 0.5426934097421203
F1 0.07920378037050976
BCR 0.7631615422285112

--------------
Class 3 detect + classif
--------------
Accuracy 0.9983259556228015
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 4 detect + classif
--------------
Accuracy 0.9996240526203071
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 5 detect + classif
--------------
Accuracy 0.9993066544226974
Precision 0.0
Recall 0.0
F1 nan
BCR 0.49999922908270095

--------------
Class 6 detect + classif
--------------
Accuracy 0.9998674939563377
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 7 detect + classif
--------------
Accuracy 0.9996895352581634
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
GLOBAL detect + classif
--------------
Average Accuracy 0.9954345119694559
Average Precision nan
Average Recall 0.19103104090192202
Average F1 nan
Average BCR 0.5685863001320656
KAPPA 0.15417603595430346 \\
CEN 0.019330319641057213 \\
--------------
Confusion matrix detect
--------------
[[1273402   18664]
 [   2482    3506]]
--------------
Class 0 detect
--------------
Accuracy 0.9837094604692871
Precision 0.9980546820870863
Recall 0.985554917473256
F1 0.991765415993302
BCR 0.785529629745312

--------------
Class 1 detect
--------------
Accuracy 0.9837094604692871
Precision 0.15814163283716734
Recall 0.5855043420173681
F1 0.24902336813694156
BCR 0.785529629745312

--------------
GLOBAL detect
--------------
Average Accuracy 0.9837094604692871
Average Precision 0.5780981574621268
Average Recall 0.785529629745312
Average F1 0.6203943920651218
Average BCR 0.785529629745312
KAPPA 0.2435282678860939 \\
CEN 0.06826372524989095 \\
--------------
Confusion matrix classif
--------------
[[   0   59    0    0    0    0    0]
 [   0  947    0    0    0    0    0]
 [   0 1332    0    0    0    0    0]
 [   0  298    0    0    0    0    0]
 [   0  537    0    0    0    0    0]
 [   0   99    0    0    0    0    0]
 [   0  234    0    0    0    0    0]]
--------------
Class 1 classif
--------------
Accuracy 0.9831717056474615
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 2 classif
--------------
Accuracy 0.27010838562464345
Precision 0.27010838562464345
Recall 1.0
F1 0.4253312373680665
BCR 0.5

--------------
Class 3 classif
--------------
Accuracy 0.6200798630918426
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 4 classif
--------------
Accuracy 0.91500285225328
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 5 classif
--------------
Accuracy 0.8468339988590987
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 6 classif
--------------
Accuracy 0.9717626925270965
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 7 classif
--------------
Accuracy 0.9332572732458643
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
GLOBAL classif
--------------
Average Accuracy 0.791459538749898
Average Precision nan
Average Recall 0.14285714285714285
Average F1 nan
Average BCR 0.5
KAPPA 0.0 \\
CEN 0.2795353677979115 \\
hnm classification
^[[D    ^[[D    ^[[D     ^[[C     ^[[C    ^[[D    ^[[D    Compute or load features
^[[D    Tune cls_cnn

 tune cnn
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:00<?, ?trial/s, best loss=?]                                                                                                                        CNN params= 
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        {'nb_conv_layers': 2, 'nb_dense_layers': 4, 'nb_filters': 48, 'filter_size': 2, 'pool_size': 2, 'nb_dense_nodes': 320, 'dropout_proba': 0.7000000000000002, 'learn_rate_adam': 0.003727593720314938, 'beta_1': 0.95, 'beta_2': 0.95, 'epsilon': 1e-08, 'min_delta': 0.0005, 'patience': 5, 'batchsize': 384}
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        Model: "sequential"
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        Layer (type)                 Output Shape              Param #   
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d (QuantConv2D)   (None, 130, 20, 48)       240       
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d (MaxPooling2D) (None, 65, 10, 48)        0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_1 (QuantConv2D) (None, 65, 10, 48)        9264      
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_1 (MaxPooling2 (None, 32, 5, 48)         0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_2 (QuantConv2D) (None, 32, 5, 48)         9264      
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_2 (MaxPooling2 (None, 16, 2, 48)         0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        dropout (Dropout)            (None, 16, 2, 48)         0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        flatten (Flatten)            (None, 1536)              0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_dense (QuantDense)     (None, 320)               491840    
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        dropout_1 (Dropout)          (None, 320)               0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_1 (QuantDense)   (None, 320)               102720    
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        dropout_2 (Dropout)          (None, 320)               0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_2 (QuantDense)   (None, 320)               102720    
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        dropout_3 (Dropout)          (None, 320)               0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_3 (QuantDense)   (None, 320)               102720    
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        dropout_4 (Dropout)          (None, 320)               0         
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_4 (QuantDense)   (None, 8)                 2568      
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        Total params: 821,336
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        Trainable params: 821,336
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        Non-trainable params: 0
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]/home/ndewinter/.local/lib/python3.6/site-packages/sklearn/utils/validation.py:72: FutureWarning: Pass classes=[0 1 2 3 4 5 6 7], y=[0 7 7 ... 3 3 3] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  "will result in an error", FutureWarning)

                                                                                                                        Fit the CNN
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:31<?, ?trial/s, best loss=?]2021-12-09 17:51:44.221926: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 5319516800 exceeds 10% of free system memory.
                                                                                                                        Train on 511492 samples, validate on 56833 samples
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:34<?, ?trial/s, best loss=?]                                                                                                                        Epoch 1/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:34<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 24s - loss: 4.6137 - accuracy: 0.3557 - sparse_categorical_accuracy: 0.3557 - val_loss: 6.0367 - val_accuracy: 0.2063 - val_sparse_categorical_accuracy: 0.2063

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:58<?, ?trial/s, best loss=?]                                                                                                                        Epoch 2/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [00:58<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 3.4863 - accuracy: 0.3718 - sparse_categorical_accuracy: 0.3718 - val_loss: 24.3530 - val_accuracy: 0.2981 - val_sparse_categorical_accuracy: 0.2981

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [01:21<?, ?trial/s, best loss=?]                                                                                                                        Epoch 3/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [01:21<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 2.3472 - accuracy: 0.4223 - sparse_categorical_accuracy: 0.4223 - val_loss: 6.7918 - val_accuracy: 0.0532 - val_sparse_categorical_accuracy: 0.0532

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [01:44<?, ?trial/s, best loss=?]                                                                                                                        Epoch 4/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [01:44<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 2.2099 - accuracy: 0.4028 - sparse_categorical_accuracy: 0.4028 - val_loss: 5.5691 - val_accuracy: 0.0427 - val_sparse_categorical_accuracy: 0.0427

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [02:07<?, ?trial/s, best loss=?]                                                                                                                        Epoch 5/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [02:07<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 1.6417 - accuracy: 0.5189 - sparse_categorical_accuracy: 0.5189 - val_loss: 1.4754 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [02:30<?, ?trial/s, best loss=?]                                                                                                                        Epoch 6/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [02:30<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 1.6173 - accuracy: 0.5603 - sparse_categorical_accuracy: 0.5603 - val_loss: 3.2255 - val_accuracy: 0.0280 - val_sparse_categorical_accuracy: 0.0280

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [02:53<?, ?trial/s, best loss=?]                                                                                                                        Epoch 7/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [02:53<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 1.6132 - accuracy: 0.5606 - sparse_categorical_accuracy: 0.5606 - val_loss: 4.2527 - val_accuracy: 0.0477 - val_sparse_categorical_accuracy: 0.0477

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [03:16<?, ?trial/s, best loss=?]                                                                                                                        Epoch 8/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [03:16<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 1.6148 - accuracy: 0.5612 - sparse_categorical_accuracy: 0.5612 - val_loss: 2.4709 - val_accuracy: 0.1505 - val_sparse_categorical_accuracy: 0.1505

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [03:39<?, ?trial/s, best loss=?]                                                                                                                        Epoch 9/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [03:39<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 1.6262 - accuracy: 0.5610 - sparse_categorical_accuracy: 0.5610 - val_loss: 2.6703 - val_accuracy: 0.1490 - val_sparse_categorical_accuracy: 0.1490

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [04:02<?, ?trial/s, best loss=?]                                                                                                                        Epoch 10/200
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [04:02<?, ?trial/s, best loss=?]                                                                                                                        Restoring model weights from the end of the best epoch.
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [04:25<?, ?trial/s, best loss=?]                                                                                                                        511492/511492 - 23s - loss: 1.6340 - accuracy: 0.5611 - sparse_categorical_accuracy: 0.5611 - val_loss: 1.9788 - val_accuracy: 0.1503 - val_sparse_categorical_accuracy: 0.1503

 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [04:25<?, ?trial/s, best loss=?]                                                                                                                        Epoch 00010: early stopping
 92%|████████████████████████████████████████████████████████████████████▊      | 11/12 [04:25<?, ?trial/s, best loss=?]100%|████████████████████████████████████████████████| 12/12 [04:25<00:00, 265.85s/trial, best loss: 0.7151261377825546]100%|████████████████████████████████████████████████| 12/12 [04:25<00:00, 265.85s/trial, best loss: 0.7151261377825546]
best_space= {'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'pool_size': 2, 'patience': 20, 'min_delta': 0.005, 'batchsize': 320, 'filter_size': 3, 'nb_dense_layers': 2, 'nb_output': 8, 'beta_2': 0.999, 'epsilon': 1e-08, 'nb_conv_layers': 3, 'nb_filters': 48, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8}
total tuning time 265.868 (secs) = 4.43 min \\
Fit cls_cnn
CNN params=  {'nb_conv_layers': 3, 'nb_dense_layers': 2, 'nb_filters': 48, 'filter_size': 3, 'pool_size': 2, 'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8, 'beta_2': 0.999, 'epsilon': 1e-08, 'min_delta': 0.005, 'patience': 20, 'batchsize': 320}
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
quant_conv2d (QuantConv2D)   (None, 130, 20, 48)       480       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 65, 10, 48)        0         
_________________________________________________________________
quant_conv2d_1 (QuantConv2D) (None, 65, 10, 48)        20784     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 32, 5, 48)         0         
_________________________________________________________________
quant_conv2d_2 (QuantConv2D) (None, 32, 5, 48)         20784     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 16, 2, 48)         0         
_________________________________________________________________
quant_conv2d_3 (QuantConv2D) (None, 16, 2, 48)         20784     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 8, 1, 48)          0         
_________________________________________________________________
dropout (Dropout)            (None, 8, 1, 48)          0         
_________________________________________________________________
flatten (Flatten)            (None, 384)               0         
_________________________________________________________________
quant_dense (QuantDense)     (None, 192)               73920     
_________________________________________________________________
dropout_1 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_1 (QuantDense)   (None, 192)               37056     
_________________________________________________________________
dropout_2 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_2 (QuantDense)   (None, 8)                 1544      
=================================================================
Total params: 175,352
Trainable params: 175,352
Non-trainable params: 0
_________________________________________________________________
Fit the CNN
Train on 511492 samples, validate on 56833 samples
Epoch 1/200
511492/511492 - 26s - loss: 10.1487 - accuracy: 0.3666 - sparse_categorical_accuracy: 0.3666 - val_loss: 6.9955 - val_accuracy: 0.5149 - val_sparse_categorical_accuracy: 0.5149
Epoch 2/200
511492/511492 - 25s - loss: 7.4940 - accuracy: 0.3878 - sparse_categorical_accuracy: 0.3878 - val_loss: 7.3251 - val_accuracy: 0.4807 - val_sparse_categorical_accuracy: 0.4807
Epoch 3/200
511492/511492 - 25s - loss: 5.9536 - accuracy: 0.3946 - sparse_categorical_accuracy: 0.3946 - val_loss: 3.7306 - val_accuracy: 0.4943 - val_sparse_categorical_accuracy: 0.4943
Epoch 4/200
511492/511492 - 25s - loss: 5.1113 - accuracy: 0.3973 - sparse_categorical_accuracy: 0.3973 - val_loss: 4.8576 - val_accuracy: 0.1827 - val_sparse_categorical_accuracy: 0.1827
Epoch 5/200
511492/511492 - 25s - loss: 4.5904 - accuracy: 0.4026 - sparse_categorical_accuracy: 0.4026 - val_loss: 3.2986 - val_accuracy: 0.5435 - val_sparse_categorical_accuracy: 0.5435
Epoch 6/200
511492/511492 - 25s - loss: 3.8905 - accuracy: 0.4158 - sparse_categorical_accuracy: 0.4158 - val_loss: 2.9567 - val_accuracy: 0.5705 - val_sparse_categorical_accuracy: 0.5705
Epoch 7/200
511492/511492 - 25s - loss: 3.6948 - accuracy: 0.4243 - sparse_categorical_accuracy: 0.4243 - val_loss: 4.3247 - val_accuracy: 0.1042 - val_sparse_categorical_accuracy: 0.1042
Epoch 8/200
511492/511492 - 25s - loss: 4.1017 - accuracy: 0.4108 - sparse_categorical_accuracy: 0.4108 - val_loss: 4.1681 - val_accuracy: 0.2585 - val_sparse_categorical_accuracy: 0.2585
Epoch 9/200
511492/511492 - 25s - loss: 3.8459 - accuracy: 0.4168 - sparse_categorical_accuracy: 0.4168 - val_loss: 8.0465 - val_accuracy: 0.0526 - val_sparse_categorical_accuracy: 0.0526
Epoch 10/200
511492/511492 - 25s - loss: 3.3677 - accuracy: 0.4380 - sparse_categorical_accuracy: 0.4380 - val_loss: 3.0521 - val_accuracy: 0.5697 - val_sparse_categorical_accuracy: 0.5697
Epoch 11/200
511492/511492 - 25s - loss: 3.1996 - accuracy: 0.4486 - sparse_categorical_accuracy: 0.4486 - val_loss: 2.3274 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 12/200
511492/511492 - 25s - loss: 3.5333 - accuracy: 0.4316 - sparse_categorical_accuracy: 0.4316 - val_loss: 2.5576 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 13/200
511492/511492 - 25s - loss: 3.4882 - accuracy: 0.4324 - sparse_categorical_accuracy: 0.4324 - val_loss: 1.7027 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 14/200
511492/511492 - 25s - loss: 3.3675 - accuracy: 0.4369 - sparse_categorical_accuracy: 0.4369 - val_loss: 2.1677 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 15/200
^[[D    511492/511492 - 25s - loss: 2.8861 - accuracy: 0.4541 - sparse_categorical_accuracy: 0.4541 - val_loss: 1.6937 - val_accuracy: 0.5695 - val_sparse_categorical_accuracy: 0.5695
Epoch 16/200
511492/511492 - 25s - loss: 3.0969 - accuracy: 0.4463 - sparse_categorical_accuracy: 0.4463 - val_loss: 2.0569 - val_accuracy: 0.2996 - val_sparse_categorical_accuracy: 0.2996
Epoch 17/200
511492/511492 - 25s - loss: 3.0763 - accuracy: 0.4487 - sparse_categorical_accuracy: 0.4487 - val_loss: 1.3361 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 18/200
511492/511492 - 25s - loss: 3.4006 - accuracy: 0.4344 - sparse_categorical_accuracy: 0.4344 - val_loss: 9.0837 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 19/200
511492/511492 - 25s - loss: 3.8350 - accuracy: 0.4197 - sparse_categorical_accuracy: 0.4197 - val_loss: 4.9998 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 20/200
511492/511492 - 25s - loss: 3.5686 - accuracy: 0.4238 - sparse_categorical_accuracy: 0.4238 - val_loss: 1.2929 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 21/200
511492/511492 - 25s - loss: 3.5963 - accuracy: 0.4217 - sparse_categorical_accuracy: 0.4217 - val_loss: 1.9185 - val_accuracy: 0.2996 - val_sparse_categorical_accuracy: 0.2996
Epoch 22/200
511492/511492 - 25s - loss: 3.7046 - accuracy: 0.4166 - sparse_categorical_accuracy: 0.4166 - val_loss: 5.2051 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 23/200
511492/511492 - 25s - loss: 3.7056 - accuracy: 0.4164 - sparse_categorical_accuracy: 0.4164 - val_loss: 3.7245 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 24/200
511492/511492 - 25s - loss: 3.7373 - accuracy: 0.4163 - sparse_categorical_accuracy: 0.4163 - val_loss: 1.8838 - val_accuracy: 0.2996 - val_sparse_categorical_accuracy: 0.2996
Epoch 25/200
511492/511492 - 25s - loss: 3.7200 - accuracy: 0.4183 - sparse_categorical_accuracy: 0.4183 - val_loss: 5.0634 - val_accuracy: 0.0281 - val_sparse_categorical_accuracy: 0.0281
Epoch 26/200
511492/511492 - 25s - loss: 3.9562 - accuracy: 0.4144 - sparse_categorical_accuracy: 0.4144 - val_loss: 4.5698 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 27/200
511492/511492 - 25s - loss: 3.9753 - accuracy: 0.4096 - sparse_categorical_accuracy: 0.4096 - val_loss: 2.2160 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 28/200
511492/511492 - 25s - loss: 3.9993 - accuracy: 0.4138 - sparse_categorical_accuracy: 0.4138 - val_loss: 2.7446 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 29/200
^[[D    511492/511492 - 25s - loss: 4.0196 - accuracy: 0.4119 - sparse_categorical_accuracy: 0.4119 - val_loss: 3.1290 - val_accuracy: 0.2996 - val_sparse_categorical_accuracy: 0.2996
Epoch 30/200
511492/511492 - 25s - loss: 4.4644 - accuracy: 0.4051 - sparse_categorical_accuracy: 0.4051 - val_loss: 2.2421 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 31/200
511492/511492 - 25s - loss: 4.4627 - accuracy: 0.4043 - sparse_categorical_accuracy: 0.4043 - val_loss: 4.1016 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 32/200
511492/511492 - 25s - loss: 4.6759 - accuracy: 0.3982 - sparse_categorical_accuracy: 0.3982 - val_loss: 2.6893 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 33/200
511492/511492 - 25s - loss: 4.5633 - accuracy: 0.4002 - sparse_categorical_accuracy: 0.4002 - val_loss: 6.8965 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 34/200
511492/511492 - 25s - loss: 4.8679 - accuracy: 0.3971 - sparse_categorical_accuracy: 0.3971 - val_loss: 2.9435 - val_accuracy: 0.0527 - val_sparse_categorical_accuracy: 0.0527
Epoch 35/200
511492/511492 - 25s - loss: 4.8516 - accuracy: 0.3975 - sparse_categorical_accuracy: 0.3975 - val_loss: 4.1153 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 36/200
511492/511492 - 25s - loss: 4.5164 - accuracy: 0.4009 - sparse_categorical_accuracy: 0.4009 - val_loss: 1.7612 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 37/200
511492/511492 - 25s - loss: 4.5993 - accuracy: 0.3997 - sparse_categorical_accuracy: 0.3997 - val_loss: 4.4569 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 38/200
511492/511492 - 25s - loss: 4.6247 - accuracy: 0.3989 - sparse_categorical_accuracy: 0.3989 - val_loss: 7.6207 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 39/200
511492/511492 - 25s - loss: 4.6962 - accuracy: 0.3974 - sparse_categorical_accuracy: 0.3974 - val_loss: 4.0965 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 40/200
Restoring model weights from the end of the best epoch.
511492/511492 - 25s - loss: 4.4485 - accuracy: 0.4013 - sparse_categorical_accuracy: 0.4013 - val_loss: 3.9526 - val_accuracy: 0.5779 - val_sparse_categorical_accuracy: 0.5779
Epoch 00040: early stopping
	hmn round 1
09\_12\_21\_17\_16\_06\_classif\_batmen\_hnm1
mod_params= {'nb_conv_layers': 3, 'nb_dense_layers': 2, 'nb_filters': 48, 'filter_size': 3, 'pool_size': 2, 'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8, 'beta_2': 0.999, 'epsilon': 1e-08, 'min_delta': 0.005, 'patience': 20, 'batchsize': 320, 'win_size': 0.23, 'chunk_size': 0, 'max_freq': 270, 'min_freq': 10, 'mean_log_mag': 0.5, 'slice_scale': 0.02322, 'overlap': 0.75, 'crop_spec': True, 'denoise': True, 'smooth_spec': True, 'nms_win_size': 21, 'smooth_op_prediction_sigma': 1.0335917312661498, 'num_hnm': 2}
--------------
Confusion matrix detect + classif
--------------
[[1292149       0       0       0       0       0       0       0]
 [    109       0       0       0       0       0       0       0]
 [   1745       0       0       0       0       0       0       0]
 [   2120       0       0       0       0       0       0       0]
 [    482       0       0       0       0       0       0       0]
 [    882       0       0       0       0       0       0       0]
 [    171       0       0       0       0       0       0       0]
 [    396       0       0       0       0       0       0       0]]
--------------
Class 0 detect + classif
--------------
Accuracy 0.9954508826289199
Precision 0.9954508826289199
Recall 1.0
F1 0.9977202559027227
BCR 0.5

--------------
Class 1 detect + classif
--------------
Accuracy 0.9999160281467488
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 2 detect + classif
--------------
Accuracy 0.9986556799640076
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 3 detect + classif
--------------
Accuracy 0.9983667859734648
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 4 detect + classif
--------------
Accuracy 0.9996286749241557
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 5 detect + classif
--------------
Accuracy 0.9993205213342434
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 6 detect + classif
--------------
Accuracy 0.9998682643403125
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 7 detect + classif
--------------
Accuracy 0.9996949279459868
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
GLOBAL detect + classif
--------------
Average Accuracy 0.99886272065723
Average Precision nan
Average Recall 0.125
Average F1 nan
Average BCR 0.5
KAPPA 0.0 \\
CEN 0.0066000382106875775 \\
--------------
Confusion matrix detect
--------------
[[1292149       0]
 [   5905       0]]
--------------
Class 0 detect
--------------
Accuracy 0.9954508826289199
Precision 0.9954508826289199
Recall 1.0
F1 0.9977202559027227
BCR 0.5

--------------
Class 1 detect
--------------
Accuracy 0.9954508826289199
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
GLOBAL detect
--------------
Average Accuracy 0.9954508826289199
Average Precision nan
Average Recall 0.5
Average F1 nan
Average BCR 0.5
KAPPA 0.0 \\
CEN 0.019963602319402814 \\
--------------
Confusion matrix classif
--------------
[[0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]]
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:205: RuntimeWarning: invalid value encountered in true_divide
  AC = (TP+TN)/(TP+FP+FN+TN).astype(float)
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:207: RuntimeWarning: invalid value encountered in true_divide
  REC = TP/(TP+FN).astype(float)
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:209: RuntimeWarning: invalid value encountered in true_divide
  SPEC = TN/(TN+FP)
--------------
Class 1 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 2 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 3 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 4 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 5 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 6 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 7 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
GLOBAL classif
--------------
Average Accuracy nan
Average Precision nan
Average Recall nan
Average F1 nan
Average BCR nan
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:271: RuntimeWarning: invalid value encountered in true_divide
  P_gt = np.sum(conf_matrix,axis=1) / tot
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:272: RuntimeWarning: invalid value encountered in true_divide
  P_pred = np.sum(conf_matrix,axis=0) / tot
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:274: RuntimeWarning: invalid value encountered in long_scalars
  agree = np.trace(conf_matrix) / tot
KAPPA nan \\
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:300: RuntimeWarning: invalid value encountered in long_scalars
  P_d[i][j] = CM[i][j] / (np.sum(CM, axis=0)[j] + np.sum(CM, axis=1)[j])
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:301: RuntimeWarning: invalid value encountered in long_scalars
  P_g[i][j] = CM[i][j] / (np.sum(CM, axis=0)[i] + np.sum(CM, axis=1)[i])
/home/ndewinter/code/batML_main/batML_multiclass/evaluate.py:308: RuntimeWarning: invalid value encountered in long_scalars
  P[j] = (np.sum(CM, axis=0)[j] + np.sum(CM, axis=1)[j]) / (2*CM.sum())
CEN nan \\
hnm classification
2021-12-09 18:14:05.702023: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3800000000 Hz
2021-12-09 18:14:05.702819: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556407377ee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-12-09 18:14:05.702837: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-12-09 18:14:05.710611: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-12-09 18:14:05.800980: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55640733c9d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-12-09 18:14:05.801010: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 SUPER, Compute Capability 7.5
2021-12-09 18:14:05.801336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 18:14:05.811666: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:14:05.824067: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:14:05.831297: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 18:14:05.849946: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 18:14:05.856994: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 18:14:05.864547: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 18:14:05.873688: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:14:05.874079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 18:14:05.874122: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:14:05.874352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-09 18:14:05.874360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-09 18:14:05.874365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-09 18:14:05.874675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2143 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)

Model: batmen
test set detect: uk
test set classif: Natagora
Generate training positions
Train classifier
Compute or load features
^[[D    ^[[D    Tune cls_cnn

 tune cnn
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:00<?, ?trial/s, best loss=?]                                                                                                                        CNN params= 
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:18<?, ?trial/s, best loss=?]                                                                                                                        {'nb_conv_layers': 2, 'nb_dense_layers': 3, 'nb_filters': 40, 'filter_size': 2, 'pool_size': 2, 'nb_dense_nodes': 192, 'dropout_proba': 0.3, 'learn_rate_adam': 0.006105402296585327, 'beta_1': 0.9, 'beta_2': 0.95, 'epsilon': 1e-08, 'min_delta': 5e-05, 'patience': 20, 'batchsize': 512}
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:18<?, ?trial/s, best loss=?]2021-12-09 18:20:04.047198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 18:20:04.075641: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:20:04.075723: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:20:04.075735: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 18:20:04.075744: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 18:20:04.075753: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 18:20:04.075762: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 18:20:04.075771: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:20:04.076129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 18:20:04.076961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 18:20:04.077001: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:20:04.077011: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:20:04.077019: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 18:20:04.077028: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 18:20:04.077036: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 18:20:04.077044: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 18:20:04.077052: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:20:04.077287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 18:20:04.077312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-09 18:20:04.077317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-09 18:20:04.077322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-09 18:20:04.077579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2143 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)
                                                                                                                        Model: "sequential"
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        Layer (type)                 Output Shape              Param #   
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d (QuantConv2D)   (None, 130, 20, 40)       200       
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d (MaxPooling2D) (None, 65, 10, 40)        0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_1 (QuantConv2D) (None, 65, 10, 40)        6440      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_1 (MaxPooling2 (None, 32, 5, 40)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_2 (QuantConv2D) (None, 32, 5, 40)         6440      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_2 (MaxPooling2 (None, 16, 2, 40)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        dropout (Dropout)            (None, 16, 2, 40)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        flatten (Flatten)            (None, 1280)              0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        quant_dense (QuantDense)     (None, 192)               245952    
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        dropout_1 (Dropout)          (None, 192)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_1 (QuantDense)   (None, 192)               37056     
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        dropout_2 (Dropout)          (None, 192)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_2 (QuantDense)   (None, 192)               37056     
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        dropout_3 (Dropout)          (None, 192)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_3 (QuantDense)   (None, 8)                 1544      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        Total params: 334,688
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        Trainable params: 334,688
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        Non-trainable params: 0
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]/home/ndewinter/.local/lib/python3.6/site-packages/sklearn/utils/validation.py:72: FutureWarning: Pass classes=[0 1 2 3 4 5 6 7], y=[7 7 7 ... 3 3 0] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  "will result in an error", FutureWarning)

                                                                                                                        Fit the CNN
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]2021-12-09 18:20:05.202579: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2909088000 exceeds 10% of free system memory.
2021-12-09 18:20:06.581362: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 323232000 exceeds 10% of free system memory.
                                                                                                                        Train on 279720 samples, validate on 31080 samples
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:21<?, ?trial/s, best loss=?]                                                                                                                        Epoch 1/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:21<?, ?trial/s, best loss=?]2021-12-09 18:20:07.593457: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:20:07.922704: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:20:09.673204: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.75GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:20:09.673254: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.75GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:20:09.693920: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.00G (1073741824 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:09.694313: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 921.60M (966367744 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:09.847651: W tensorflow/core/common_runtime/bfc_allocator.cc:311] Garbage collection: deallocate free memory regions (i.e., allocations) so that we can re-allocate a larger region to avoid OOM due to memory fragmentation. If you see this message frequently, you are running near the threshold of the available device memory and re-allocation may incur great performance overhead. You may try smaller batch sizes to observe the performance impact. Set TF_ENABLE_GPU_GARBAGE_COLLECTION=false if you'd like to disable this feature.
2021-12-09 18:20:09.875825: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:09.875861: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.32GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:20:09.876302: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:09.876313: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.32GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:20:09.878212: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:09.878235: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 16.00MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:20:09.878645: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:09.878654: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 16.00MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:20:09.879745: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:09.880153: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:19.881820: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:19.882265: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:19.882283: W tensorflow/core/common_runtime/bfc_allocator.cc:434] Allocator (GPU_0_bfc) ran out of memory trying to allocate 56.72MiB (rounded to 59473920)
Current allocation summary follows.
2021-12-09 18:20:19.882294: I tensorflow/core/common_runtime/bfc_allocator.cc:928] BFCAllocator dump for GPU_0_bfc
2021-12-09 18:20:19.882301: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (256): 	Total Chunks: 63, Chunks in use: 62. 15.8KiB allocated for chunks. 15.5KiB in use in bin. 1.9KiB client-requested in use in bin.
2021-12-09 18:20:19.882307: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (512): 	Total Chunks: 11, Chunks in use: 11. 8.2KiB allocated for chunks. 8.2KiB in use in bin. 7.9KiB client-requested in use in bin.
2021-12-09 18:20:19.882312: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (1024): 	Total Chunks: 3, Chunks in use: 3. 3.5KiB allocated for chunks. 3.5KiB in use in bin. 2.4KiB client-requested in use in bin.
2021-12-09 18:20:19.882318: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882324: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (4096): 	Total Chunks: 7, Chunks in use: 5. 42.5KiB allocated for chunks. 30.2KiB in use in bin. 30.2KiB client-requested in use in bin.
2021-12-09 18:20:19.882329: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (8192): 	Total Chunks: 1, Chunks in use: 0. 12.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882335: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (16384): 	Total Chunks: 10, Chunks in use: 9. 246.8KiB allocated for chunks. 228.2KiB in use in bin. 225.0KiB client-requested in use in bin.
2021-12-09 18:20:19.882341: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (32768): 	Total Chunks: 1, Chunks in use: 0. 45.5KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882345: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882351: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (131072): 	Total Chunks: 6, Chunks in use: 6. 864.0KiB allocated for chunks. 864.0KiB in use in bin. 864.0KiB client-requested in use in bin.
2021-12-09 18:20:19.882356: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (262144): 	Total Chunks: 3, Chunks in use: 1. 832.8KiB allocated for chunks. 263.0KiB in use in bin. 144.0KiB client-requested in use in bin.
2021-12-09 18:20:19.882362: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (524288): 	Total Chunks: 3, Chunks in use: 2. 2.81MiB allocated for chunks. 1.88MiB in use in bin. 1.88MiB client-requested in use in bin.
2021-12-09 18:20:19.882367: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (1048576): 	Total Chunks: 3, Chunks in use: 2. 3.37MiB allocated for chunks. 2.17MiB in use in bin. 1.88MiB client-requested in use in bin.
2021-12-09 18:20:19.882372: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882377: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882382: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (8388608): 	Total Chunks: 3, Chunks in use: 2. 35.29MiB allocated for chunks. 22.79MiB in use in bin. 17.77MiB client-requested in use in bin.
2021-12-09 18:20:19.882388: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (16777216): 	Total Chunks: 1, Chunks in use: 0. 30.06MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882393: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (33554432): 	Total Chunks: 4, Chunks in use: 4. 213.44MiB allocated for chunks. 213.44MiB in use in bin. 203.12MiB client-requested in use in bin.
2021-12-09 18:20:19.882398: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882403: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:19.882408: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (268435456): 	Total Chunks: 1, Chunks in use: 1. 256.00MiB allocated for chunks. 256.00MiB in use in bin. 203.12MiB client-requested in use in bin.
2021-12-09 18:20:19.882414: I tensorflow/core/common_runtime/bfc_allocator.cc:951] Bin for 56.72MiB was 32.00MiB, Chunk State: 
2021-12-09 18:20:19.882418: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 268435456
2021-12-09 18:20:19.882426: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb7cc000000 of size 53248000 next 105
2021-12-09 18:20:19.882430: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb7cf2c8000 of size 53248000 next 120
2021-12-09 18:20:19.882434: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb7d2590000 of size 53248000 next 121
2021-12-09 18:20:19.882438: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb7d5858000 of size 13107200 next 124
2021-12-09 18:20:19.882442: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb7d64d8000 of size 64061440 next 128
2021-12-09 18:20:19.882446: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb7da1f0000 of size 31522816 next 18446744073709551615
2021-12-09 18:20:19.882450: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 268435456
2021-12-09 18:20:19.882454: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb834000000 of size 268435456 next 18446744073709551615
2021-12-09 18:20:19.882458: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 16777216
2021-12-09 18:20:19.882462: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb844000000 of size 1265664 next 116
2021-12-09 18:20:19.882467: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb844135000 of size 15511552 next 18446744073709551615
2021-12-09 18:20:19.882471: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 8388608
2021-12-09 18:20:19.882475: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb846c00000 of size 8388608 next 18446744073709551615
2021-12-09 18:20:19.882479: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 2097152
2021-12-09 18:20:19.882483: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920000000 of size 983040 next 48
2021-12-09 18:20:19.882487: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9200f0000 of size 1114112 next 18446744073709551615
2021-12-09 18:20:19.882491: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 4194304
2021-12-09 18:20:19.882495: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb920200000 of size 983040 next 19
2021-12-09 18:20:19.882499: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9202f0000 of size 147456 next 61
2021-12-09 18:20:19.882503: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920314000 of size 147456 next 63
2021-12-09 18:20:19.882507: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920338000 of size 983040 next 69
2021-12-09 18:20:19.882510: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920428000 of size 147456 next 70
2021-12-09 18:20:19.882517: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb92044c000 of size 6400 next 111
2021-12-09 18:20:19.882520: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb92044d900 of size 288512 next 96
2021-12-09 18:20:19.882525: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920494000 of size 147456 next 99
2021-12-09 18:20:19.882529: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204b8000 of size 147456 next 100
2021-12-09 18:20:19.882533: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204dc000 of size 25600 next 101
2021-12-09 18:20:19.882537: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e2400 of size 256 next 102
2021-12-09 18:20:19.882541: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb9204e2500 of size 12288 next 104
2021-12-09 18:20:19.882545: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5500 of size 256 next 117
2021-12-09 18:20:19.882549: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5600 of size 256 next 118
2021-12-09 18:20:19.882553: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5700 of size 256 next 141
2021-12-09 18:20:19.882557: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5800 of size 256 next 142
2021-12-09 18:20:19.882561: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5900 of size 256 next 140
2021-12-09 18:20:19.882565: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb9204e5a00 of size 256 next 106
2021-12-09 18:20:19.882569: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5b00 of size 256 next 107
2021-12-09 18:20:19.882573: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5c00 of size 1156096 next 18446744073709551615
2021-12-09 18:20:19.882576: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 1048576
2021-12-09 18:20:19.882581: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00000 of size 1280 next 1
2021-12-09 18:20:19.882585: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00500 of size 256 next 5
2021-12-09 18:20:19.882588: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00600 of size 256 next 8
2021-12-09 18:20:19.882593: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00700 of size 256 next 2
2021-12-09 18:20:19.882597: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00800 of size 256 next 3
2021-12-09 18:20:19.882601: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00900 of size 256 next 4
2021-12-09 18:20:19.882605: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00a00 of size 256 next 10
2021-12-09 18:20:19.882609: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00b00 of size 256 next 9
2021-12-09 18:20:19.882613: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00c00 of size 256 next 13
2021-12-09 18:20:19.882617: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00d00 of size 256 next 6
2021-12-09 18:20:19.882621: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00e00 of size 768 next 7
2021-12-09 18:20:19.882625: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01100 of size 256 next 17
2021-12-09 18:20:19.882629: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01200 of size 768 next 16
2021-12-09 18:20:19.882633: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01500 of size 256 next 21
2021-12-09 18:20:19.882637: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01600 of size 256 next 22
2021-12-09 18:20:19.882641: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01700 of size 768 next 20
2021-12-09 18:20:19.882645: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01a00 of size 768 next 25
2021-12-09 18:20:19.882648: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01d00 of size 256 next 30
2021-12-09 18:20:19.882652: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01e00 of size 256 next 33
2021-12-09 18:20:19.882656: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01f00 of size 256 next 34
2021-12-09 18:20:19.882660: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02000 of size 256 next 35
2021-12-09 18:20:19.882664: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02100 of size 256 next 36
2021-12-09 18:20:19.882668: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02200 of size 256 next 37
2021-12-09 18:20:19.882672: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02300 of size 256 next 38
2021-12-09 18:20:19.882676: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02400 of size 256 next 39
2021-12-09 18:20:19.882680: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02500 of size 256 next 40
2021-12-09 18:20:19.882684: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02600 of size 256 next 41
2021-12-09 18:20:19.882687: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02700 of size 256 next 42
2021-12-09 18:20:19.882691: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02800 of size 768 next 43
2021-12-09 18:20:19.882695: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02b00 of size 256 next 44
2021-12-09 18:20:19.882699: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02c00 of size 256 next 45
2021-12-09 18:20:19.882703: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02d00 of size 256 next 47
2021-12-09 18:20:19.882707: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02e00 of size 768 next 49
2021-12-09 18:20:19.882711: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03100 of size 1024 next 27
2021-12-09 18:20:19.882715: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03500 of size 256 next 28
2021-12-09 18:20:19.882719: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03600 of size 256 next 29
2021-12-09 18:20:19.882723: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03700 of size 768 next 51
2021-12-09 18:20:19.882727: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03a00 of size 256 next 53
2021-12-09 18:20:19.882731: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03b00 of size 768 next 54
2021-12-09 18:20:19.882735: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03e00 of size 256 next 55
2021-12-09 18:20:19.882738: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03f00 of size 256 next 57
2021-12-09 18:20:19.882742: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04000 of size 256 next 59
2021-12-09 18:20:19.882746: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04100 of size 768 next 60
2021-12-09 18:20:19.882750: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04400 of size 768 next 62
2021-12-09 18:20:19.882754: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04700 of size 768 next 64
2021-12-09 18:20:19.882758: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04a00 of size 256 next 66
2021-12-09 18:20:19.882762: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04b00 of size 1280 next 31
2021-12-09 18:20:19.882766: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadae05000 of size 6144 next 32
2021-12-09 18:20:19.882771: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae06800 of size 28928 next 12
2021-12-09 18:20:19.882775: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae0d900 of size 25600 next 11
2021-12-09 18:20:19.882779: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae13d00 of size 25600 next 14
2021-12-09 18:20:19.882783: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae1a100 of size 25600 next 46
2021-12-09 18:20:19.882787: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae20500 of size 269312 next 24
2021-12-09 18:20:19.882791: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadae62100 of size 294912 next 26
2021-12-09 18:20:19.882795: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaeaa100 of size 147456 next 50
2021-12-09 18:20:19.882799: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaece100 of size 6144 next 52
2021-12-09 18:20:19.882803: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaecf900 of size 25600 next 56
2021-12-09 18:20:19.882807: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaed5d00 of size 25600 next 58
2021-12-09 18:20:19.882810: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaedc100 of size 6144 next 65
2021-12-09 18:20:19.882815: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaedd900 of size 6144 next 67
2021-12-09 18:20:19.882818: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaedf100 of size 25600 next 68
2021-12-09 18:20:19.882823: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5500 of size 256 next 71
2021-12-09 18:20:19.882827: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5600 of size 256 next 72
2021-12-09 18:20:19.882830: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5700 of size 256 next 73
2021-12-09 18:20:19.882834: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5800 of size 256 next 74
2021-12-09 18:20:19.882838: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5900 of size 256 next 75
2021-12-09 18:20:19.882842: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5a00 of size 256 next 76
2021-12-09 18:20:19.882846: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5b00 of size 256 next 77
2021-12-09 18:20:19.882850: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5c00 of size 256 next 78
2021-12-09 18:20:19.882854: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5d00 of size 256 next 79
2021-12-09 18:20:19.882858: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5e00 of size 256 next 80
2021-12-09 18:20:19.882862: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5f00 of size 256 next 81
2021-12-09 18:20:19.882866: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6000 of size 256 next 82
2021-12-09 18:20:19.882870: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6100 of size 256 next 83
2021-12-09 18:20:19.882873: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6200 of size 256 next 84
2021-12-09 18:20:19.882877: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6300 of size 256 next 85
2021-12-09 18:20:19.882881: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6400 of size 256 next 86
2021-12-09 18:20:19.882885: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6500 of size 256 next 87
2021-12-09 18:20:19.882889: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6600 of size 256 next 88
2021-12-09 18:20:19.882893: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6700 of size 256 next 89
2021-12-09 18:20:19.882897: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6800 of size 256 next 90
2021-12-09 18:20:19.882901: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6900 of size 256 next 91
2021-12-09 18:20:19.882905: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6a00 of size 6144 next 94
2021-12-09 18:20:19.882909: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadaee8200 of size 6400 next 113
2021-12-09 18:20:19.882912: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee9b00 of size 256 next 114
2021-12-09 18:20:19.882916: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadaee9c00 of size 18944 next 97
2021-12-09 18:20:19.882920: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaeee600 of size 25600 next 98
2021-12-09 18:20:19.882924: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadaef4a00 of size 46592 next 18446744073709551615
2021-12-09 18:20:19.882928: I tensorflow/core/common_runtime/bfc_allocator.cc:989]      Summary of in-use Chunks by size: 
2021-12-09 18:20:19.882934: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 62 Chunks of size 256 totalling 15.5KiB
2021-12-09 18:20:19.882938: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 11 Chunks of size 768 totalling 8.2KiB
2021-12-09 18:20:19.882943: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1024 totalling 1.0KiB
2021-12-09 18:20:19.882947: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 1280 totalling 2.5KiB
2021-12-09 18:20:19.882955: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 4 Chunks of size 6144 totalling 24.0KiB
2021-12-09 18:20:19.882959: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 6400 totalling 6.2KiB
2021-12-09 18:20:19.882963: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 8 Chunks of size 25600 totalling 200.0KiB
2021-12-09 18:20:19.882968: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 28928 totalling 28.2KiB
2021-12-09 18:20:19.882972: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 6 Chunks of size 147456 totalling 864.0KiB
2021-12-09 18:20:19.882976: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 269312 totalling 263.0KiB
2021-12-09 18:20:19.882981: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 983040 totalling 1.88MiB
2021-12-09 18:20:19.882985: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1114112 totalling 1.06MiB
2021-12-09 18:20:19.882989: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1156096 totalling 1.10MiB
2021-12-09 18:20:19.882993: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 8388608 totalling 8.00MiB
2021-12-09 18:20:19.882998: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 15511552 totalling 14.79MiB
2021-12-09 18:20:19.883002: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 3 Chunks of size 53248000 totalling 152.34MiB
2021-12-09 18:20:19.883007: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 64061440 totalling 61.09MiB
2021-12-09 18:20:19.883011: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 268435456 totalling 256.00MiB
2021-12-09 18:20:19.883015: I tensorflow/core/common_runtime/bfc_allocator.cc:996] Sum Total of in-use chunks: 497.65MiB
2021-12-09 18:20:19.883019: I tensorflow/core/common_runtime/bfc_allocator.cc:998] total_region_allocated_bytes_: 569376768 memory_limit_: 2247426048 available bytes: 1678049280 curr_region_allocation_bytes_: 2147483648
2021-12-09 18:20:19.883026: I tensorflow/core/common_runtime/bfc_allocator.cc:1004] Stats: 
Limit:                  2247426048
InUse:                   521824000
MaxInUse:               1437675520
NumAllocs:                     389
MaxAllocSize:            869731072

2021-12-09 18:20:19.883037: W tensorflow/core/common_runtime/bfc_allocator.cc:439] *****************************_**********xx_____**************************************xxxxxxxxx******
2021-12-09 18:20:19.895833: W tensorflow/core/framework/op_kernel.cc:1732] OP_REQUIRES failed at conv_grad_input_ops.cc:1108 : Resource exhausted: OOM when allocating tensor with shape[512,40,66,11] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
2021-12-09 18:20:19.896387: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:19.896763: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:29.897351: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:29.897772: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.56G (1678049280 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:20:29.897792: W tensorflow/core/common_runtime/bfc_allocator.cc:434] Allocator (GPU_0_bfc) ran out of memory trying to allocate 56.72MiB (rounded to 59473920)
Current allocation summary follows.
2021-12-09 18:20:29.897819: I tensorflow/core/common_runtime/bfc_allocator.cc:928] BFCAllocator dump for GPU_0_bfc
2021-12-09 18:20:29.897828: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (256): 	Total Chunks: 63, Chunks in use: 62. 15.8KiB allocated for chunks. 15.5KiB in use in bin. 1.9KiB client-requested in use in bin.
2021-12-09 18:20:29.897838: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (512): 	Total Chunks: 11, Chunks in use: 11. 8.2KiB allocated for chunks. 8.2KiB in use in bin. 7.9KiB client-requested in use in bin.
2021-12-09 18:20:29.897847: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (1024): 	Total Chunks: 3, Chunks in use: 3. 3.5KiB allocated for chunks. 3.5KiB in use in bin. 2.4KiB client-requested in use in bin.
2021-12-09 18:20:29.897855: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897860: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (4096): 	Total Chunks: 7, Chunks in use: 5. 42.5KiB allocated for chunks. 30.2KiB in use in bin. 30.2KiB client-requested in use in bin.
2021-12-09 18:20:29.897866: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (8192): 	Total Chunks: 1, Chunks in use: 0. 12.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897872: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (16384): 	Total Chunks: 8, Chunks in use: 8. 203.2KiB allocated for chunks. 203.2KiB in use in bin. 200.0KiB client-requested in use in bin.
2021-12-09 18:20:29.897877: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897882: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (65536): 	Total Chunks: 1, Chunks in use: 0. 89.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897887: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (131072): 	Total Chunks: 6, Chunks in use: 6. 864.0KiB allocated for chunks. 864.0KiB in use in bin. 864.0KiB client-requested in use in bin.
2021-12-09 18:20:29.897893: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (262144): 	Total Chunks: 3, Chunks in use: 1. 832.8KiB allocated for chunks. 263.0KiB in use in bin. 144.0KiB client-requested in use in bin.
2021-12-09 18:20:29.897900: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (524288): 	Total Chunks: 3, Chunks in use: 2. 2.81MiB allocated for chunks. 1.88MiB in use in bin. 1.88MiB client-requested in use in bin.
2021-12-09 18:20:29.897908: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (1048576): 	Total Chunks: 3, Chunks in use: 2. 3.37MiB allocated for chunks. 2.17MiB in use in bin. 1.88MiB client-requested in use in bin.
2021-12-09 18:20:29.897914: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897922: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897930: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (8388608): 	Total Chunks: 3, Chunks in use: 2. 35.29MiB allocated for chunks. 22.79MiB in use in bin. 17.77MiB client-requested in use in bin.
2021-12-09 18:20:29.897937: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (16777216): 	Total Chunks: 1, Chunks in use: 0. 30.06MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897946: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (33554432): 	Total Chunks: 4, Chunks in use: 3. 213.44MiB allocated for chunks. 162.66MiB in use in bin. 152.34MiB client-requested in use in bin.
2021-12-09 18:20:29.897958: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897965: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:20:29.897974: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (268435456): 	Total Chunks: 1, Chunks in use: 1. 256.00MiB allocated for chunks. 256.00MiB in use in bin. 203.12MiB client-requested in use in bin.
2021-12-09 18:20:29.897982: I tensorflow/core/common_runtime/bfc_allocator.cc:951] Bin for 56.72MiB was 32.00MiB, Chunk State: 
2021-12-09 18:20:29.897993: I tensorflow/core/common_runtime/bfc_allocator.cc:957]   Size: 50.78MiB | Requested Size: 50.78MiB | in_use: 0 | bin_num: 17, prev:   Size: 50.78MiB | Requested Size: 50.78MiB | in_use: 1 | bin_num: -1, next:   Size: 50.78MiB | Requested Size: 50.78MiB | in_use: 1 | bin_num: -1
2021-12-09 18:20:29.898001: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 268435456
2021-12-09 18:20:29.898009: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb7cc000000 of size 53248000 next 105
2021-12-09 18:20:29.898016: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb7cf2c8000 of size 53248000 next 120
2021-12-09 18:20:29.898021: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb7d2590000 of size 53248000 next 121
2021-12-09 18:20:29.898027: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb7d5858000 of size 13107200 next 124
2021-12-09 18:20:29.898033: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb7d64d8000 of size 64061440 next 128
2021-12-09 18:20:29.898040: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb7da1f0000 of size 31522816 next 18446744073709551615
2021-12-09 18:20:29.898046: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 268435456
2021-12-09 18:20:29.898052: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb834000000 of size 268435456 next 18446744073709551615
2021-12-09 18:20:29.898059: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 16777216
2021-12-09 18:20:29.898065: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb844000000 of size 1265664 next 116
2021-12-09 18:20:29.898071: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb844135000 of size 15511552 next 18446744073709551615
2021-12-09 18:20:29.898077: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 8388608
2021-12-09 18:20:29.898084: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb846c00000 of size 8388608 next 18446744073709551615
2021-12-09 18:20:29.898090: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 2097152
2021-12-09 18:20:29.898096: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920000000 of size 983040 next 48
2021-12-09 18:20:29.898103: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9200f0000 of size 1114112 next 18446744073709551615
2021-12-09 18:20:29.898109: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 4194304
2021-12-09 18:20:29.898115: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb920200000 of size 983040 next 19
2021-12-09 18:20:29.898122: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9202f0000 of size 147456 next 61
2021-12-09 18:20:29.898128: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920314000 of size 147456 next 63
2021-12-09 18:20:29.898134: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920338000 of size 983040 next 69
2021-12-09 18:20:29.898140: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920428000 of size 147456 next 70
2021-12-09 18:20:29.898147: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb92044c000 of size 6400 next 111
2021-12-09 18:20:29.898152: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb92044d900 of size 288512 next 96
2021-12-09 18:20:29.898159: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb920494000 of size 147456 next 99
2021-12-09 18:20:29.898165: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204b8000 of size 147456 next 100
2021-12-09 18:20:29.898171: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204dc000 of size 25600 next 101
2021-12-09 18:20:29.898177: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e2400 of size 256 next 102
2021-12-09 18:20:29.898183: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb9204e2500 of size 12288 next 104
2021-12-09 18:20:29.898189: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5500 of size 256 next 117
2021-12-09 18:20:29.898194: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5600 of size 256 next 118
2021-12-09 18:20:29.898200: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5700 of size 256 next 141
2021-12-09 18:20:29.898205: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5800 of size 256 next 142
2021-12-09 18:20:29.898211: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5900 of size 256 next 140
2021-12-09 18:20:29.898217: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fb9204e5a00 of size 256 next 106
2021-12-09 18:20:29.898223: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5b00 of size 256 next 107
2021-12-09 18:20:29.898229: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fb9204e5c00 of size 1156096 next 18446744073709551615
2021-12-09 18:20:29.898236: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 1048576
2021-12-09 18:20:29.898242: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00000 of size 1280 next 1
2021-12-09 18:20:29.898249: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00500 of size 256 next 5
2021-12-09 18:20:29.898255: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00600 of size 256 next 8
2021-12-09 18:20:29.898261: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00700 of size 256 next 2
2021-12-09 18:20:29.898266: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00800 of size 256 next 3
2021-12-09 18:20:29.898272: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00900 of size 256 next 4
2021-12-09 18:20:29.898278: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00a00 of size 256 next 10
2021-12-09 18:20:29.898284: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00b00 of size 256 next 9
2021-12-09 18:20:29.898290: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00c00 of size 256 next 13
2021-12-09 18:20:29.898296: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00d00 of size 256 next 6
2021-12-09 18:20:29.898302: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae00e00 of size 768 next 7
2021-12-09 18:20:29.898308: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01100 of size 256 next 17
2021-12-09 18:20:29.898313: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01200 of size 768 next 16
2021-12-09 18:20:29.898317: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01500 of size 256 next 21
2021-12-09 18:20:29.898321: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01600 of size 256 next 22
2021-12-09 18:20:29.898325: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01700 of size 768 next 20
2021-12-09 18:20:29.898329: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01a00 of size 768 next 25
2021-12-09 18:20:29.898333: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01d00 of size 256 next 30
2021-12-09 18:20:29.898337: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01e00 of size 256 next 33
2021-12-09 18:20:29.898341: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae01f00 of size 256 next 34
2021-12-09 18:20:29.898345: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02000 of size 256 next 35
2021-12-09 18:20:29.898349: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02100 of size 256 next 36
2021-12-09 18:20:29.898353: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02200 of size 256 next 37
2021-12-09 18:20:29.898356: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02300 of size 256 next 38
2021-12-09 18:20:29.898360: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02400 of size 256 next 39
2021-12-09 18:20:29.898364: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02500 of size 256 next 40
2021-12-09 18:20:29.898368: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02600 of size 256 next 41
2021-12-09 18:20:29.898372: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02700 of size 256 next 42
2021-12-09 18:20:29.898376: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02800 of size 768 next 43
2021-12-09 18:20:29.898380: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02b00 of size 256 next 44
2021-12-09 18:20:29.898384: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02c00 of size 256 next 45
2021-12-09 18:20:29.898388: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02d00 of size 256 next 47
2021-12-09 18:20:29.898392: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae02e00 of size 768 next 49
2021-12-09 18:20:29.898396: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03100 of size 1024 next 27
2021-12-09 18:20:29.898400: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03500 of size 256 next 28
2021-12-09 18:20:29.898404: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03600 of size 256 next 29
2021-12-09 18:20:29.898408: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03700 of size 768 next 51
2021-12-09 18:20:29.898412: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03a00 of size 256 next 53
2021-12-09 18:20:29.898416: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03b00 of size 768 next 54
2021-12-09 18:20:29.898420: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03e00 of size 256 next 55
2021-12-09 18:20:29.898424: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae03f00 of size 256 next 57
2021-12-09 18:20:29.898428: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04000 of size 256 next 59
2021-12-09 18:20:29.898432: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04100 of size 768 next 60
2021-12-09 18:20:29.898435: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04400 of size 768 next 62
2021-12-09 18:20:29.898439: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04700 of size 768 next 64
2021-12-09 18:20:29.898443: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04a00 of size 256 next 66
2021-12-09 18:20:29.898447: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae04b00 of size 1280 next 31
2021-12-09 18:20:29.898451: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadae05000 of size 6144 next 32
2021-12-09 18:20:29.898455: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae06800 of size 28928 next 12
2021-12-09 18:20:29.898459: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae0d900 of size 25600 next 11
2021-12-09 18:20:29.898463: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae13d00 of size 25600 next 14
2021-12-09 18:20:29.898467: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae1a100 of size 25600 next 46
2021-12-09 18:20:29.898471: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadae20500 of size 269312 next 24
2021-12-09 18:20:29.898475: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadae62100 of size 294912 next 26
2021-12-09 18:20:29.898479: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaeaa100 of size 147456 next 50
2021-12-09 18:20:29.898483: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaece100 of size 6144 next 52
2021-12-09 18:20:29.898487: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaecf900 of size 25600 next 56
2021-12-09 18:20:29.898491: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaed5d00 of size 25600 next 58
2021-12-09 18:20:29.898495: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaedc100 of size 6144 next 65
2021-12-09 18:20:29.898498: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaedd900 of size 6144 next 67
2021-12-09 18:20:29.898502: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaedf100 of size 25600 next 68
2021-12-09 18:20:29.898506: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5500 of size 256 next 71
2021-12-09 18:20:29.898510: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5600 of size 256 next 72
2021-12-09 18:20:29.898514: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5700 of size 256 next 73
2021-12-09 18:20:29.898518: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5800 of size 256 next 74
2021-12-09 18:20:29.898522: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5900 of size 256 next 75
2021-12-09 18:20:29.898526: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5a00 of size 256 next 76
2021-12-09 18:20:29.898530: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5b00 of size 256 next 77
2021-12-09 18:20:29.898534: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5c00 of size 256 next 78
2021-12-09 18:20:29.898538: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5d00 of size 256 next 79
2021-12-09 18:20:29.898541: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5e00 of size 256 next 80
2021-12-09 18:20:29.898546: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee5f00 of size 256 next 81
2021-12-09 18:20:29.898549: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6000 of size 256 next 82
2021-12-09 18:20:29.898553: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6100 of size 256 next 83
2021-12-09 18:20:29.898557: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6200 of size 256 next 84
2021-12-09 18:20:29.898561: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6300 of size 256 next 85
2021-12-09 18:20:29.898565: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6400 of size 256 next 86
2021-12-09 18:20:29.898568: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6500 of size 256 next 87
2021-12-09 18:20:29.898572: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6600 of size 256 next 88
2021-12-09 18:20:29.898575: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6700 of size 256 next 89
2021-12-09 18:20:29.898579: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6800 of size 256 next 90
2021-12-09 18:20:29.898583: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6900 of size 256 next 91
2021-12-09 18:20:29.898586: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee6a00 of size 6144 next 94
2021-12-09 18:20:29.898590: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadaee8200 of size 6400 next 113
2021-12-09 18:20:29.898593: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7fbadaee9b00 of size 256 next 114
2021-12-09 18:20:29.898597: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7fbadaee9c00 of size 91136 next 18446744073709551615
2021-12-09 18:20:29.898601: I tensorflow/core/common_runtime/bfc_allocator.cc:989]      Summary of in-use Chunks by size: 
2021-12-09 18:20:29.898608: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 62 Chunks of size 256 totalling 15.5KiB
2021-12-09 18:20:29.898613: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 11 Chunks of size 768 totalling 8.2KiB
2021-12-09 18:20:29.898617: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1024 totalling 1.0KiB
2021-12-09 18:20:29.898622: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 1280 totalling 2.5KiB
2021-12-09 18:20:29.898626: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 4 Chunks of size 6144 totalling 24.0KiB
2021-12-09 18:20:29.898630: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 6400 totalling 6.2KiB
2021-12-09 18:20:29.898635: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 7 Chunks of size 25600 totalling 175.0KiB
2021-12-09 18:20:29.898639: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 28928 totalling 28.2KiB
2021-12-09 18:20:29.898643: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 6 Chunks of size 147456 totalling 864.0KiB
2021-12-09 18:20:29.898648: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 269312 totalling 263.0KiB
2021-12-09 18:20:29.898652: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 983040 totalling 1.88MiB
2021-12-09 18:20:29.898656: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1114112 totalling 1.06MiB
2021-12-09 18:20:29.898660: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1156096 totalling 1.10MiB
2021-12-09 18:20:29.898665: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 8388608 totalling 8.00MiB
2021-12-09 18:20:29.898669: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 15511552 totalling 14.79MiB
2021-12-09 18:20:29.898673: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 53248000 totalling 101.56MiB
2021-12-09 18:20:29.898678: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 64061440 totalling 61.09MiB
2021-12-09 18:20:29.898682: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 268435456 totalling 256.00MiB
2021-12-09 18:20:29.898686: I tensorflow/core/common_runtime/bfc_allocator.cc:996] Sum Total of in-use chunks: 446.84MiB
2021-12-09 18:20:29.898691: I tensorflow/core/common_runtime/bfc_allocator.cc:998] total_region_allocated_bytes_: 569376768 memory_limit_: 2247426048 available bytes: 1678049280 curr_region_allocation_bytes_: 2147483648
2021-12-09 18:20:29.898698: I tensorflow/core/common_runtime/bfc_allocator.cc:1004] Stats: 
Limit:                  2247426048
InUse:                   468550400
MaxInUse:               1437675520
NumAllocs:                     390
MaxAllocSize:            869731072

2021-12-09 18:20:29.898712: W tensorflow/core/common_runtime/bfc_allocator.cc:439] **********________***********_**********xx_____**************************************xxxxxxxxx******
2021-12-09 18:20:29.898728: W tensorflow/core/framework/op_kernel.cc:1732] OP_REQUIRES failed at conv_grad_filter_ops.cc:809 : Resource exhausted: OOM when allocating tensor with shape[512,40,66,11] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
job exception:  OOM when allocating tensor with shape[512,40,66,11] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node gradient_tape/sequential/quant_conv2d_1/Conv2DBackpropInput (defined at /home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py:113) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_distributed_function_1945]

Errors may have originated from an input operation.
Input Source operations connected to node gradient_tape/sequential/quant_conv2d_1/Conv2DBackpropInput:
 sequential/quant_conv2d_1/Conv2D/ste_sign_1/IdentityN (defined at /home/ndewinter/.local/lib/python3.6/site-packages/larq/quantizers.py:89)

Function call stack:
distributed_function

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:44<?, ?trial/s, best loss=?]
Traceback (most recent call last):
  File "run_training.py", line 251, in <module>
    test_files_classif, test_pos_classif, test_durations_classif, test_classes_classif)
  File "/home/ndewinter/code/batML_main/batML_multiclass/classifier.py", line 90, in train
    self.model.train(positions, class_labels, files, durations)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cls_cnn.py", line 66, in train
    tune_network(self.params, features, labels, self.params.trials_filename_1)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 209, in tune_network
    best_space_indices = fmin(obj_func_cnn, space_cnn, trials=trials, algo=tpe.suggest, max_evals=max_trials)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 555, in fmin
    trials_save_file=trials_save_file,
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/base.py", line 688, in fmin
    trials_save_file=trials_save_file,
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 300, in run
    self.serial_evaluate()
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 178, in serial_evaluate
    result = self.domain.evaluate(spec, ctrl)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/base.py", line 892, in evaluate
    rval = self.fn(pyll_rval)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 151, in obj_func_cnn
    _, history = network_fit(params_cnn, args['features'], args['labels'], args['nb_output'])
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 113, in network_fit
    validation_split=params.validation_split, callbacks=[callback])
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training.py", line 718, in fit
    use_multiprocessing=use_multiprocessing)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2.py", line 341, in fit
    total_epochs=epochs)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2.py", line 128, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2_utils.py", line 98, in execution_function
    distributed_function(input_fn))
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py", line 576, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py", line 640, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 2414, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 1660, in _filtered_call
    self.captured_inputs)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 1741, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager))
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 598, in call
    ctx=ctx)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/execute.py", line 60, in quick_execute
    inputs, attrs, num_outputs)
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[512,40,66,11] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node gradient_tape/sequential/quant_conv2d_1/Conv2DBackpropInput (defined at /home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py:113) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_distributed_function_1945]

Errors may have originated from an input operation.
Input Source operations connected to node gradient_tape/sequential/quant_conv2d_1/Conv2DBackpropInput:
 sequential/quant_conv2d_1/Conv2D/ste_sign_1/IdentityN (defined at /home/ndewinter/.local/lib/python3.6/site-packages/larq/quantizers.py:89)

Function call stack:
distributed_function

2021-12-09 18:21:03.107038: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3800000000 Hz
2021-12-09 18:21:03.107789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56036a7a1ee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-12-09 18:21:03.107811: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-12-09 18:21:03.115714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-12-09 18:21:03.176677: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56036a7669d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-12-09 18:21:03.176707: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 SUPER, Compute Capability 7.5
2021-12-09 18:21:03.177020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 18:21:03.178315: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:21:03.182891: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:21:03.190436: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 18:21:03.209035: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 18:21:03.216259: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 18:21:03.224002: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 18:21:03.233863: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:21:03.234246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 18:21:03.234286: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:21:03.234513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-09 18:21:03.234521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-09 18:21:03.234526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-09 18:21:03.234838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2143 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)

Model: batmen
test set detect: uk
test set classif: Natagora
Generate training positions
Train classifier
Compute or load features
Tune cls_cnn

 tune cnn
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:00<?, ?trial/s, best loss=?]                                                                                                                        CNN params= 
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]                                                                                                                        {'nb_conv_layers': 2, 'nb_dense_layers': 3, 'nb_filters': 56, 'filter_size': 2, 'pool_size': 2, 'nb_dense_nodes': 128, 'dropout_proba': 0.6000000000000001, 'learn_rate_adam': 2.6826957952797274e-05, 'beta_1': 0.8, 'beta_2': 0.95, 'epsilon': 1e-08, 'min_delta': 5e-05, 'patience': 15, 'batchsize': 512}
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:19<?, ?trial/s, best loss=?]2021-12-09 18:26:38.750374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 18:26:38.780791: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:26:38.786556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:26:38.786587: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 18:26:38.786598: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 18:26:38.786614: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 18:26:38.786623: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 18:26:38.793601: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:26:38.794014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 18:26:38.824940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-09 18:26:38.825010: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-09 18:26:38.825021: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:26:38.825029: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-09 18:26:38.825038: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-09 18:26:38.825046: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-09 18:26:38.825054: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-09 18:26:38.825064: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:26:38.825335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-09 18:26:38.825396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-09 18:26:38.825403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-09 18:26:38.825414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-09 18:26:38.825707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2143 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)
                                                                                                                        Model: "sequential"
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        Layer (type)                 Output Shape              Param #   
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d (QuantConv2D)   (None, 130, 20, 56)       280       
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d (MaxPooling2D) (None, 65, 10, 56)        0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_1 (QuantConv2D) (None, 65, 10, 56)        12600     
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_1 (MaxPooling2 (None, 32, 5, 56)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_2 (QuantConv2D) (None, 32, 5, 56)         12600     
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_2 (MaxPooling2 (None, 16, 2, 56)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        dropout (Dropout)            (None, 16, 2, 56)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        flatten (Flatten)            (None, 1792)              0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        quant_dense (QuantDense)     (None, 128)               229504    
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        dropout_1 (Dropout)          (None, 128)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_1 (QuantDense)   (None, 128)               16512     
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        dropout_2 (Dropout)          (None, 128)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_2 (QuantDense)   (None, 128)               16512     
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        dropout_3 (Dropout)          (None, 128)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_3 (QuantDense)   (None, 8)                 1032      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        Total params: 289,040
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        Trainable params: 289,040
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        Non-trainable params: 0
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:20<?, ?trial/s, best loss=?]/home/ndewinter/.local/lib/python3.6/site-packages/sklearn/utils/validation.py:72: FutureWarning: Pass classes=[0 1 2 3 4 5 6 7], y=[7 7 7 ... 3 3 3] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  "will result in an error", FutureWarning)

                                                                                                                        Fit the CNN
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:21<?, ?trial/s, best loss=?]2021-12-09 18:26:40.566649: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2909088000 exceeds 10% of free system memory.
2021-12-09 18:26:42.000392: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 323232000 exceeds 10% of free system memory.
                                                                                                                        Train on 279720 samples, validate on 31080 samples
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:22<?, ?trial/s, best loss=?]                                                                                                                        Epoch 1/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:22<?, ?trial/s, best loss=?]2021-12-09 18:26:43.111588: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-09 18:26:43.634373: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-09 18:26:46.322564: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.00G (1073741824 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.323007: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 921.60M (966367744 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.373196: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.96GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.373233: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.96GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.401015: W tensorflow/core/common_runtime/bfc_allocator.cc:311] Garbage collection: deallocate free memory regions (i.e., allocations) so that we can re-allocate a larger region to avoid OOM due to memory fragmentation. If you see this message frequently, you are running near the threshold of the available device memory and re-allocation may incur great performance overhead. You may try smaller batch sizes to observe the performance impact. Set TF_ENABLE_GPU_GARBAGE_COLLECTION=false if you'd like to disable this feature.
2021-12-09 18:26:46.419860: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.419885: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.02GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.420280: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.420291: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.02GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.420668: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.420677: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 505.06MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.421044: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.421052: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 505.06MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.428966: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.428990: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.02GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.429385: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.429394: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.02GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.429761: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.429770: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 505.06MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.430146: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.430156: W tensorflow/core/common_runtime/bfc_allocator.cc:245] Allocator (GPU_0_bfc) ran out of memory trying to allocate 505.06MiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2021-12-09 18:26:46.451730: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.452113: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.482860: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:46.483236: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:56.483766: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:56.484189: I tensorflow/stream_executor/cuda/cuda_driver.cc:763] failed to allocate 1.06G (1141178368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2021-12-09 18:26:56.484205: W tensorflow/core/common_runtime/bfc_allocator.cc:434] Allocator (GPU_0_bfc) ran out of memory trying to allocate 284.38MiB (rounded to 298188800)
Current allocation summary follows.
2021-12-09 18:26:56.484216: I tensorflow/core/common_runtime/bfc_allocator.cc:928] BFCAllocator dump for GPU_0_bfc
2021-12-09 18:26:56.484223: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (256): 	Total Chunks: 62, Chunks in use: 62. 15.5KiB allocated for chunks. 15.5KiB in use in bin. 2.5KiB client-requested in use in bin.
2021-12-09 18:26:56.484229: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (512): 	Total Chunks: 9, Chunks in use: 9. 4.5KiB allocated for chunks. 4.5KiB in use in bin. 4.5KiB client-requested in use in bin.
2021-12-09 18:26:56.484234: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (1024): 	Total Chunks: 6, Chunks in use: 5. 7.8KiB allocated for chunks. 6.2KiB in use in bin. 4.5KiB client-requested in use in bin.
2021-12-09 18:26:56.484238: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484244: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (4096): 	Total Chunks: 5, Chunks in use: 4. 23.8KiB allocated for chunks. 19.8KiB in use in bin. 16.0KiB client-requested in use in bin.
2021-12-09 18:26:56.484249: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484254: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (16384): 	Total Chunks: 1, Chunks in use: 0. 16.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484260: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (32768): 	Total Chunks: 8, Chunks in use: 6. 393.5KiB allocated for chunks. 295.5KiB in use in bin. 294.0KiB client-requested in use in bin.
2021-12-09 18:26:56.484266: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (65536): 	Total Chunks: 10, Chunks in use: 8. 735.8KiB allocated for chunks. 545.5KiB in use in bin. 497.0KiB client-requested in use in bin.
2021-12-09 18:26:56.484271: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (131072): 	Total Chunks: 1, Chunks in use: 0. 194.0KiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484276: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484287: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (524288): 	Total Chunks: 4, Chunks in use: 3. 3.50MiB allocated for chunks. 2.62MiB in use in bin. 2.62MiB client-requested in use in bin.
2021-12-09 18:26:56.484293: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (1048576): 	Total Chunks: 2, Chunks in use: 1. 2.40MiB allocated for chunks. 1.12MiB in use in bin. 896.0KiB client-requested in use in bin.
2021-12-09 18:26:56.484298: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484303: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484308: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (8388608): 	Total Chunks: 2, Chunks in use: 1. 23.74MiB allocated for chunks. 8.00MiB in use in bin. 5.08MiB client-requested in use in bin.
2021-12-09 18:26:56.484313: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484317: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484323: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (67108864): 	Total Chunks: 2, Chunks in use: 2. 142.19MiB allocated for chunks. 142.19MiB in use in bin. 142.19MiB client-requested in use in bin.
2021-12-09 18:26:56.484328: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (134217728): 	Total Chunks: 3, Chunks in use: 0. 597.44MiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2021-12-09 18:26:56.484334: I tensorflow/core/common_runtime/bfc_allocator.cc:935] Bin (268435456): 	Total Chunks: 1, Chunks in use: 1. 284.38MiB allocated for chunks. 284.38MiB in use in bin. 284.38MiB client-requested in use in bin.
2021-12-09 18:26:56.484340: I tensorflow/core/common_runtime/bfc_allocator.cc:951] Bin for 284.38MiB was 256.00MiB, Chunk State: 
2021-12-09 18:26:56.484351: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 536870912
2021-12-09 18:26:56.484357: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f130e000000 of size 198008832 next 128
2021-12-09 18:26:56.484363: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f1319cd6000 of size 74547200 next 114
2021-12-09 18:26:56.484367: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f131e3ee000 of size 264314880 next 18446744073709551615
2021-12-09 18:26:56.484371: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 536870912
2021-12-09 18:26:56.484375: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f1378000000 of size 298188800 next 118
2021-12-09 18:26:56.484380: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f1389c60000 of size 74547200 next 104
2021-12-09 18:26:56.484384: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f138e378000 of size 164134912 next 18446744073709551615
2021-12-09 18:26:56.484388: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 16777216
2021-12-09 18:26:56.484392: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f1398000000 of size 198656 next 107
2021-12-09 18:26:56.484396: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f1398030800 of size 65536 next 108
2021-12-09 18:26:56.484401: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f1398040800 of size 256 next 116
2021-12-09 18:26:56.484406: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f1398040900 of size 7936 next 110
2021-12-09 18:26:56.484409: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f1398042800 of size 16504832 next 18446744073709551615
2021-12-09 18:26:56.484413: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 8388608
2021-12-09 18:26:56.484417: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f139ac00000 of size 8388608 next 18446744073709551615
2021-12-09 18:26:56.484420: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 2097152
2021-12-09 18:26:56.484424: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f1472000000 of size 917504 next 47
2021-12-09 18:26:56.484428: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14720e0000 of size 1179648 next 18446744073709551615
2021-12-09 18:26:56.484432: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 4194304
2021-12-09 18:26:56.484436: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f1472200000 of size 917504 next 20
2021-12-09 18:26:56.484440: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14722e0000 of size 917504 next 69
2021-12-09 18:26:56.484445: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14723c0000 of size 50176 next 122
2021-12-09 18:26:56.484449: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f14723cc400 of size 50176 next 96
2021-12-09 18:26:56.484453: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14723d8800 of size 256 next 97
2021-12-09 18:26:56.484456: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14723d8900 of size 256 next 98
2021-12-09 18:26:56.484460: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14723d8a00 of size 256 next 139
2021-12-09 18:26:56.484464: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14723d8b00 of size 256 next 141
2021-12-09 18:26:56.484469: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f14723d8c00 of size 1536 next 99
2021-12-09 18:26:56.484473: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14723d9200 of size 256 next 100
2021-12-09 18:26:56.484477: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f14723d9300 of size 917504 next 123
2021-12-09 18:26:56.484481: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f14724b9300 of size 1338624 next 18446744073709551615
2021-12-09 18:26:56.484485: I tensorflow/core/common_runtime/bfc_allocator.cc:964] Next region of size 1048576
2021-12-09 18:26:56.484489: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00000 of size 1280 next 1
2021-12-09 18:26:56.484493: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00500 of size 256 next 5
2021-12-09 18:26:56.484497: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00600 of size 256 next 8
2021-12-09 18:26:56.484501: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00700 of size 256 next 10
2021-12-09 18:26:56.484505: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00800 of size 256 next 2
2021-12-09 18:26:56.484509: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00900 of size 256 next 3
2021-12-09 18:26:56.484513: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00a00 of size 256 next 4
2021-12-09 18:26:56.484517: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00b00 of size 256 next 9
2021-12-09 18:26:56.484520: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00c00 of size 256 next 13
2021-12-09 18:26:56.484524: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00d00 of size 256 next 17
2021-12-09 18:26:56.484529: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00e00 of size 256 next 18
2021-12-09 18:26:56.484532: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae00f00 of size 256 next 6
2021-12-09 18:26:56.484537: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae01000 of size 1024 next 7
2021-12-09 18:26:56.484541: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae01400 of size 512 next 16
2021-12-09 18:26:56.484545: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae01600 of size 99840 next 12
2021-12-09 18:26:56.484549: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae19c00 of size 50176 next 11
2021-12-09 18:26:56.484553: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f162ae26000 of size 50176 next 14
2021-12-09 18:26:56.484557: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32400 of size 256 next 21
2021-12-09 18:26:56.484561: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32500 of size 512 next 22
2021-12-09 18:26:56.484565: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32700 of size 512 next 27
2021-12-09 18:26:56.484569: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32900 of size 256 next 31
2021-12-09 18:26:56.484573: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32a00 of size 256 next 34
2021-12-09 18:26:56.484576: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32b00 of size 256 next 35
2021-12-09 18:26:56.484580: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32c00 of size 256 next 36
2021-12-09 18:26:56.484584: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32d00 of size 256 next 37
2021-12-09 18:26:56.484588: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32e00 of size 256 next 38
2021-12-09 18:26:56.484592: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae32f00 of size 256 next 39
2021-12-09 18:26:56.484595: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33000 of size 256 next 40
2021-12-09 18:26:56.484599: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33100 of size 256 next 41
2021-12-09 18:26:56.484603: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33200 of size 256 next 42
2021-12-09 18:26:56.484607: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33300 of size 256 next 43
2021-12-09 18:26:56.484611: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33400 of size 1280 next 28
2021-12-09 18:26:56.484615: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33900 of size 256 next 29
2021-12-09 18:26:56.484618: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33a00 of size 256 next 30
2021-12-09 18:26:56.484622: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33b00 of size 256 next 44
2021-12-09 18:26:56.484626: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33c00 of size 256 next 45
2021-12-09 18:26:56.484630: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33d00 of size 256 next 46
2021-12-09 18:26:56.484634: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae33e00 of size 512 next 48
2021-12-09 18:26:56.484637: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae34000 of size 512 next 49
2021-12-09 18:26:56.484641: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae34200 of size 512 next 51
2021-12-09 18:26:56.484645: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae34400 of size 256 next 53
2021-12-09 18:26:56.484649: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae34500 of size 1792 next 32
2021-12-09 18:26:56.484653: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f162ae34c00 of size 4096 next 33
2021-12-09 18:26:56.484657: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae35c00 of size 51712 next 23
2021-12-09 18:26:56.484661: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f162ae42600 of size 65536 next 24
2021-12-09 18:26:56.484665: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae52600 of size 65536 next 26
2021-12-09 18:26:56.484669: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae62600 of size 65536 next 25
2021-12-09 18:26:56.484673: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae72600 of size 65536 next 50
2021-12-09 18:26:56.484677: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae82600 of size 4096 next 52
2021-12-09 18:26:56.484680: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae83600 of size 256 next 54
2021-12-09 18:26:56.484684: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae83700 of size 50176 next 55
2021-12-09 18:26:56.484687: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae8fb00 of size 256 next 56
2021-12-09 18:26:56.484691: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae8fc00 of size 50176 next 57
2021-12-09 18:26:56.484694: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae9c000 of size 256 next 58
2021-12-09 18:26:56.484698: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae9c100 of size 512 next 59
2021-12-09 18:26:56.484701: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162ae9c300 of size 65536 next 60
2021-12-09 18:26:56.484705: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aeac300 of size 512 next 61
2021-12-09 18:26:56.484708: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aeac500 of size 65536 next 62
2021-12-09 18:26:56.484712: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aebc500 of size 512 next 63
2021-12-09 18:26:56.484716: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aebc700 of size 4096 next 64
2021-12-09 18:26:56.484719: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aebd700 of size 256 next 65
2021-12-09 18:26:56.484723: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aebd800 of size 1024 next 66
2021-12-09 18:26:56.484727: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aebdc00 of size 4096 next 67
2021-12-09 18:26:56.484731: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aebec00 of size 50176 next 68
2021-12-09 18:26:56.484735: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aecb000 of size 65536 next 70
2021-12-09 18:26:56.484739: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb000 of size 256 next 71
2021-12-09 18:26:56.484743: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb100 of size 256 next 72
2021-12-09 18:26:56.484746: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb200 of size 256 next 73
2021-12-09 18:26:56.484750: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb300 of size 256 next 74
2021-12-09 18:26:56.484754: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb400 of size 256 next 75
2021-12-09 18:26:56.484758: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb500 of size 256 next 76
2021-12-09 18:26:56.484761: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb600 of size 256 next 77
2021-12-09 18:26:56.484765: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb700 of size 256 next 78
2021-12-09 18:26:56.484769: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb800 of size 256 next 79
2021-12-09 18:26:56.484773: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedb900 of size 256 next 80
2021-12-09 18:26:56.484777: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedba00 of size 256 next 81
2021-12-09 18:26:56.484780: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedbb00 of size 256 next 82
2021-12-09 18:26:56.484784: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedbc00 of size 256 next 83
2021-12-09 18:26:56.484788: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedbd00 of size 256 next 84
2021-12-09 18:26:56.484792: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedbe00 of size 256 next 85
2021-12-09 18:26:56.484796: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedbf00 of size 256 next 86
2021-12-09 18:26:56.484799: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedc000 of size 256 next 87
2021-12-09 18:26:56.484803: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedc100 of size 256 next 88
2021-12-09 18:26:56.484807: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedc200 of size 256 next 89
2021-12-09 18:26:56.484811: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedc300 of size 256 next 90
2021-12-09 18:26:56.484814: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedc400 of size 256 next 91
2021-12-09 18:26:56.484818: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aedc500 of size 256 next 138
2021-12-09 18:26:56.484822: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f162aedc600 of size 16384 next 112
2021-12-09 18:26:56.484826: I tensorflow/core/common_runtime/bfc_allocator.cc:984] InUse at 7f162aee0600 of size 256 next 113
2021-12-09 18:26:56.484830: I tensorflow/core/common_runtime/bfc_allocator.cc:984] Free  at 7f162aee0700 of size 129280 next 18446744073709551615
2021-12-09 18:26:56.484834: I tensorflow/core/common_runtime/bfc_allocator.cc:989]      Summary of in-use Chunks by size: 
2021-12-09 18:26:56.484839: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 62 Chunks of size 256 totalling 15.5KiB
2021-12-09 18:26:56.484843: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 9 Chunks of size 512 totalling 4.5KiB
2021-12-09 18:26:56.484847: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 1024 totalling 2.0KiB
2021-12-09 18:26:56.484851: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 1280 totalling 2.5KiB
2021-12-09 18:26:56.484855: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1792 totalling 1.8KiB
2021-12-09 18:26:56.484860: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 3 Chunks of size 4096 totalling 12.0KiB
2021-12-09 18:26:56.484864: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 7936 totalling 7.8KiB
2021-12-09 18:26:56.484868: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 5 Chunks of size 50176 totalling 245.0KiB
2021-12-09 18:26:56.484872: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 51712 totalling 50.5KiB
2021-12-09 18:26:56.484877: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 7 Chunks of size 65536 totalling 448.0KiB
2021-12-09 18:26:56.484881: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 99840 totalling 97.5KiB
2021-12-09 18:26:56.484885: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 3 Chunks of size 917504 totalling 2.62MiB
2021-12-09 18:26:56.484889: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 1179648 totalling 1.12MiB
2021-12-09 18:26:56.484893: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 8388608 totalling 8.00MiB
2021-12-09 18:26:56.484897: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 2 Chunks of size 74547200 totalling 142.19MiB
2021-12-09 18:26:56.484902: I tensorflow/core/common_runtime/bfc_allocator.cc:992] 1 Chunks of size 298188800 totalling 284.38MiB
2021-12-09 18:26:56.484906: I tensorflow/core/common_runtime/bfc_allocator.cc:996] Sum Total of in-use chunks: 439.18MiB
2021-12-09 18:26:56.484910: I tensorflow/core/common_runtime/bfc_allocator.cc:998] total_region_allocated_bytes_: 1106247680 memory_limit_: 2247426048 available bytes: 1141178368 curr_region_allocation_bytes_: 2147483648
2021-12-09 18:26:56.484917: I tensorflow/core/common_runtime/bfc_allocator.cc:1004] Stats: 
Limit:                  2247426048
InUse:                   460512256
MaxInUse:               1274881536
NumAllocs:                     403
MaxAllocSize:            529596416

2021-12-09 18:26:56.484934: W tensorflow/core/common_runtime/bfc_allocator.cc:439] _________________********_______________________***********************************______________***
2021-12-09 18:26:56.484963: W tensorflow/core/framework/op_kernel.cc:1732] OP_REQUIRES failed at pooling_ops_common.cc:296 : Resource exhausted: OOM when allocating tensor with shape[512,56,130,20] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
WARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: 
job exception:  OOM when allocating tensor with shape[512,56,130,20] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node gradient_tape/sequential/max_pooling2d/MaxPool/MaxPoolGrad (defined at /home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py:113) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_distributed_function_1945]

Errors may have originated from an input operation.
Input Source operations connected to node gradient_tape/sequential/max_pooling2d/MaxPool/MaxPoolGrad:
 sequential/quant_conv2d/BiasAdd (defined at /home/ndewinter/.local/lib/python3.6/site-packages/larq/layers_base.py:167)	
 SelectV2_10 (defined at /home/ndewinter/.local/lib/python3.6/site-packages/larq/quantizers.py:78)

Function call stack:
distributed_function

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]
Traceback (most recent call last):
  File "run_training.py", line 251, in <module>
    test_files_classif, test_pos_classif, test_durations_classif, test_classes_classif)
  File "/home/ndewinter/code/batML_main/batML_multiclass/classifier.py", line 90, in train
    self.model.train(positions, class_labels, files, durations)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cls_cnn.py", line 66, in train
    tune_network(self.params, features, labels, self.params.trials_filename_1)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 209, in tune_network
    best_space_indices = fmin(obj_func_cnn, space_cnn, trials=trials, algo=tpe.suggest, max_evals=max_trials)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 555, in fmin
    trials_save_file=trials_save_file,
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/base.py", line 688, in fmin
    trials_save_file=trials_save_file,
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 300, in run
    self.serial_evaluate()
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 178, in serial_evaluate
    result = self.domain.evaluate(spec, ctrl)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/base.py", line 892, in evaluate
    rval = self.fn(pyll_rval)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 151, in obj_func_cnn
    _, history = network_fit(params_cnn, args['features'], args['labels'], args['nb_output'])
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 113, in network_fit
    validation_split=params.validation_split, callbacks=[callback])
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training.py", line 718, in fit
    use_multiprocessing=use_multiprocessing)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2.py", line 341, in fit
    total_epochs=epochs)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2.py", line 128, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2_utils.py", line 98, in execution_function
    distributed_function(input_fn))
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py", line 576, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py", line 640, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 2414, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 1660, in _filtered_call
    self.captured_inputs)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 1741, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager))
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 598, in call
    ctx=ctx)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/execute.py", line 60, in quick_execute
    inputs, attrs, num_outputs)
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[512,56,130,20] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node gradient_tape/sequential/max_pooling2d/MaxPool/MaxPoolGrad (defined at /home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py:113) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_distributed_function_1945]

Errors may have originated from an input operation.
Input Source operations connected to node gradient_tape/sequential/max_pooling2d/MaxPool/MaxPoolGrad:
 sequential/quant_conv2d/BiasAdd (defined at /home/ndewinter/.local/lib/python3.6/site-packages/larq/layers_base.py:167)	
 SelectV2_10 (defined at /home/ndewinter/.local/lib/python3.6/site-packages/larq/quantizers.py:78)

Function call stack:
distributed_function

Compute or load features
Tune cls_cnn

 tune cnn
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:00<?, ?trial/s, best loss=?]                                                                                                                        CNN params= 
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        {'nb_conv_layers': 3, 'nb_dense_layers': 1, 'nb_filters': 48, 'filter_size': 2, 'pool_size': 2, 'nb_dense_nodes': 128, 'dropout_proba': 0.6000000000000001, 'learn_rate_adam': 4.393970560760786e-05, 'beta_1': 0.9, 'beta_2': 0.95, 'epsilon': 1e-08, 'min_delta': 0.0005, 'patience': 5, 'batchsize': 384}
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        Model: "sequential"
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        Layer (type)                 Output Shape              Param #   
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d (QuantConv2D)   (None, 130, 20, 48)       240       
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d (MaxPooling2D) (None, 65, 10, 48)        0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_1 (QuantConv2D) (None, 65, 10, 48)        9264      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_1 (MaxPooling2 (None, 32, 5, 48)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_2 (QuantConv2D) (None, 32, 5, 48)         9264      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_2 (MaxPooling2 (None, 16, 2, 48)         0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_3 (QuantConv2D) (None, 16, 2, 48)         9264      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_3 (MaxPooling2 (None, 8, 1, 48)          0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        dropout (Dropout)            (None, 8, 1, 48)          0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        flatten (Flatten)            (None, 384)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        quant_dense (QuantDense)     (None, 128)               49280     
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        dropout_1 (Dropout)          (None, 128)               0         
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_1 (QuantDense)   (None, 8)                 1032      
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        Total params: 78,344
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        Trainable params: 78,344
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        Non-trainable params: 0
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        Fit the CNN
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:37<?, ?trial/s, best loss=?]                                                                                                                        Train on 604732 samples, validate on 67193 samples
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:41<?, ?trial/s, best loss=?]                                                                                                                        Epoch 1/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [00:41<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 28s - loss: 8.3328 - accuracy: 0.2982 - sparse_categorical_accuracy: 0.2982 - val_loss: 9.7434 - val_accuracy: 0.1651 - val_sparse_categorical_accuracy: 0.1651

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [01:09<?, ?trial/s, best loss=?]                                                                                                                        Epoch 2/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [01:09<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 7.5216 - accuracy: 0.3064 - sparse_categorical_accuracy: 0.3064 - val_loss: 6.3399 - val_accuracy: 0.3745 - val_sparse_categorical_accuracy: 0.3745

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [01:36<?, ?trial/s, best loss=?]                                                                                                                        Epoch 3/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [01:36<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 6.9374 - accuracy: 0.3102 - sparse_categorical_accuracy: 0.3102 - val_loss: 5.8068 - val_accuracy: 0.4153 - val_sparse_categorical_accuracy: 0.4153

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [02:02<?, ?trial/s, best loss=?]                                                                                                                        Epoch 4/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [02:02<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 6.3009 - accuracy: 0.3123 - sparse_categorical_accuracy: 0.3123 - val_loss: 5.3257 - val_accuracy: 0.3186 - val_sparse_categorical_accuracy: 0.3186

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [02:29<?, ?trial/s, best loss=?]                                                                                                                        Epoch 5/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [02:29<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 6.0495 - accuracy: 0.3125 - sparse_categorical_accuracy: 0.3125 - val_loss: 4.6821 - val_accuracy: 0.4013 - val_sparse_categorical_accuracy: 0.4013

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [02:56<?, ?trial/s, best loss=?]                                                                                                                        Epoch 6/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [02:56<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 5.4186 - accuracy: 0.3156 - sparse_categorical_accuracy: 0.3156 - val_loss: 4.7059 - val_accuracy: 0.3902 - val_sparse_categorical_accuracy: 0.3902

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [03:23<?, ?trial/s, best loss=?]                                                                                                                        Epoch 7/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [03:23<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.8969 - accuracy: 0.3215 - sparse_categorical_accuracy: 0.3215 - val_loss: 4.4611 - val_accuracy: 0.3512 - val_sparse_categorical_accuracy: 0.3512

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [03:49<?, ?trial/s, best loss=?]                                                                                                                        Epoch 8/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [03:49<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.3615 - accuracy: 0.3246 - sparse_categorical_accuracy: 0.3246 - val_loss: 4.0618 - val_accuracy: 0.3665 - val_sparse_categorical_accuracy: 0.3665

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [04:16<?, ?trial/s, best loss=?]                                                                                                                        Epoch 9/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [04:16<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.2971 - accuracy: 0.3269 - sparse_categorical_accuracy: 0.3269 - val_loss: 3.7548 - val_accuracy: 0.4204 - val_sparse_categorical_accuracy: 0.4204

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [04:43<?, ?trial/s, best loss=?]                                                                                                                        Epoch 10/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [04:43<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.3614 - accuracy: 0.3261 - sparse_categorical_accuracy: 0.3261 - val_loss: 3.5468 - val_accuracy: 0.4690 - val_sparse_categorical_accuracy: 0.4690

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [05:09<?, ?trial/s, best loss=?]                                                                                                                        Epoch 11/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [05:09<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.3976 - accuracy: 0.3222 - sparse_categorical_accuracy: 0.3222 - val_loss: 3.7691 - val_accuracy: 0.3292 - val_sparse_categorical_accuracy: 0.3292

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [05:36<?, ?trial/s, best loss=?]                                                                                                                        Epoch 12/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [05:36<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.2407 - accuracy: 0.3101 - sparse_categorical_accuracy: 0.3101 - val_loss: 3.7038 - val_accuracy: 0.4401 - val_sparse_categorical_accuracy: 0.4401

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [06:03<?, ?trial/s, best loss=?]                                                                                                                        Epoch 13/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [06:03<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.2359 - accuracy: 0.3084 - sparse_categorical_accuracy: 0.3084 - val_loss: 4.0065 - val_accuracy: 0.3395 - val_sparse_categorical_accuracy: 0.3395

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [06:30<?, ?trial/s, best loss=?]                                                                                                                        Epoch 14/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [06:30<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.2358 - accuracy: 0.3085 - sparse_categorical_accuracy: 0.3085 - val_loss: 3.3127 - val_accuracy: 0.4047 - val_sparse_categorical_accuracy: 0.4047

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [06:56<?, ?trial/s, best loss=?]                                                                                                                        Epoch 15/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [06:56<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.4035 - accuracy: 0.3093 - sparse_categorical_accuracy: 0.3093 - val_loss: 5.9502 - val_accuracy: 0.4786 - val_sparse_categorical_accuracy: 0.4786

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [07:23<?, ?trial/s, best loss=?]                                                                                                                        Epoch 16/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [07:23<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.4368 - accuracy: 0.3048 - sparse_categorical_accuracy: 0.3048 - val_loss: 3.6019 - val_accuracy: 0.3643 - val_sparse_categorical_accuracy: 0.3643

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [07:50<?, ?trial/s, best loss=?]                                                                                                                        Epoch 17/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [07:50<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.4406 - accuracy: 0.3053 - sparse_categorical_accuracy: 0.3053 - val_loss: 4.0653 - val_accuracy: 0.3932 - val_sparse_categorical_accuracy: 0.3932

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [08:17<?, ?trial/s, best loss=?]                                                                                                                        Epoch 18/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [08:17<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.4991 - accuracy: 0.3065 - sparse_categorical_accuracy: 0.3065 - val_loss: 6.6010 - val_accuracy: 0.2830 - val_sparse_categorical_accuracy: 0.2830

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [08:43<?, ?trial/s, best loss=?]                                                                                                                        Epoch 19/200
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [08:43<?, ?trial/s, best loss=?]                                                                                                                        Restoring model weights from the end of the best epoch.
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [09:10<?, ?trial/s, best loss=?]                                                                                                                        604732/604732 - 27s - loss: 4.4140 - accuracy: 0.3076 - sparse_categorical_accuracy: 0.3076 - val_loss: 3.6837 - val_accuracy: 0.2447 - val_sparse_categorical_accuracy: 0.2447

 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [09:10<?, ?trial/s, best loss=?]                                                                                                                        Epoch 00019: early stopping
 92%|█████████████████████████████████████████████████████████████████████▏     | 12/13 [09:10<?, ?trial/s, best loss=?]100%|████████████████████████████████████████████████| 13/13 [09:10<00:00, 550.47s/trial, best loss: 0.7151261377825546]100%|████████████████████████████████████████████████| 13/13 [09:10<00:00, 550.47s/trial, best loss: 0.7151261377825546]
best_space= {'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'pool_size': 2, 'patience': 20, 'min_delta': 0.005, 'batchsize': 320, 'filter_size': 3, 'nb_dense_layers': 2, 'nb_output': 8, 'beta_2': 0.999, 'epsilon': 1e-08, 'nb_conv_layers': 3, 'nb_filters': 48, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8}
total tuning time 550.491 (secs) = 9.17 min \\
Fit cls_cnn
CNN params=  {'nb_conv_layers': 3, 'nb_dense_layers': 2, 'nb_filters': 48, 'filter_size': 3, 'pool_size': 2, 'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8, 'beta_2': 0.999, 'epsilon': 1e-08, 'min_delta': 0.005, 'patience': 20, 'batchsize': 320}
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
quant_conv2d (QuantConv2D)   (None, 130, 20, 48)       480       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 65, 10, 48)        0         
_________________________________________________________________
quant_conv2d_1 (QuantConv2D) (None, 65, 10, 48)        20784     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 32, 5, 48)         0         
_________________________________________________________________
quant_conv2d_2 (QuantConv2D) (None, 32, 5, 48)         20784     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 16, 2, 48)         0         
_________________________________________________________________
quant_conv2d_3 (QuantConv2D) (None, 16, 2, 48)         20784     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 8, 1, 48)          0         
_________________________________________________________________
dropout (Dropout)            (None, 8, 1, 48)          0         
_________________________________________________________________
flatten (Flatten)            (None, 384)               0         
_________________________________________________________________
quant_dense (QuantDense)     (None, 192)               73920     
_________________________________________________________________
dropout_1 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_1 (QuantDense)   (None, 192)               37056     
_________________________________________________________________
dropout_2 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_2 (QuantDense)   (None, 8)                 1544      
=================================================================
Total params: 175,352
Trainable params: 175,352
Non-trainable params: 0
_________________________________________________________________
Fit the CNN
Train on 604732 samples, validate on 67193 samples
Epoch 1/200
604732/604732 - 31s - loss: 11.1358 - accuracy: 0.3022 - sparse_categorical_accuracy: 0.3022 - val_loss: 14.5653 - val_accuracy: 0.0472 - val_sparse_categorical_accuracy: 0.0472
Epoch 2/200
604732/604732 - 30s - loss: 8.3027 - accuracy: 0.3131 - sparse_categorical_accuracy: 0.3131 - val_loss: 4.2820 - val_accuracy: 0.3417 - val_sparse_categorical_accuracy: 0.3417
Epoch 3/200
604732/604732 - 30s - loss: 6.3227 - accuracy: 0.3188 - sparse_categorical_accuracy: 0.3188 - val_loss: 3.4562 - val_accuracy: 0.3676 - val_sparse_categorical_accuracy: 0.3676
Epoch 4/200
604732/604732 - 30s - loss: 4.9578 - accuracy: 0.3274 - sparse_categorical_accuracy: 0.3274 - val_loss: 4.6466 - val_accuracy: 0.1193 - val_sparse_categorical_accuracy: 0.1193
Epoch 5/200
604732/604732 - 30s - loss: 4.6956 - accuracy: 0.3328 - sparse_categorical_accuracy: 0.3328 - val_loss: 5.6176 - val_accuracy: 0.0655 - val_sparse_categorical_accuracy: 0.0655
Epoch 6/200
604732/604732 - 30s - loss: 4.0371 - accuracy: 0.3442 - sparse_categorical_accuracy: 0.3442 - val_loss: 2.5922 - val_accuracy: 0.4789 - val_sparse_categorical_accuracy: 0.4789
Epoch 7/200
604732/604732 - 30s - loss: 3.6354 - accuracy: 0.3465 - sparse_categorical_accuracy: 0.3465 - val_loss: 2.5655 - val_accuracy: 0.2422 - val_sparse_categorical_accuracy: 0.2422
Epoch 8/200
604732/604732 - 30s - loss: 3.5972 - accuracy: 0.3473 - sparse_categorical_accuracy: 0.3473 - val_loss: 2.0214 - val_accuracy: 0.4671 - val_sparse_categorical_accuracy: 0.4671
Epoch 9/200
604732/604732 - 30s - loss: 3.5720 - accuracy: 0.3489 - sparse_categorical_accuracy: 0.3489 - val_loss: 4.7349 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 10/200
604732/604732 - 30s - loss: 3.2452 - accuracy: 0.3596 - sparse_categorical_accuracy: 0.3596 - val_loss: 2.1170 - val_accuracy: 0.4803 - val_sparse_categorical_accuracy: 0.4803
Epoch 11/200
604732/604732 - 30s - loss: 3.3692 - accuracy: 0.3567 - sparse_categorical_accuracy: 0.3567 - val_loss: 2.2808 - val_accuracy: 0.3267 - val_sparse_categorical_accuracy: 0.3267
Epoch 12/200
604732/604732 - 30s - loss: 3.2530 - accuracy: 0.3605 - sparse_categorical_accuracy: 0.3605 - val_loss: 3.3582 - val_accuracy: 0.3548 - val_sparse_categorical_accuracy: 0.3548
Epoch 13/200
604732/604732 - 30s - loss: 3.3995 - accuracy: 0.3601 - sparse_categorical_accuracy: 0.3601 - val_loss: 1.9224 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 14/200
604732/604732 - 30s - loss: 3.3538 - accuracy: 0.3617 - sparse_categorical_accuracy: 0.3617 - val_loss: 2.1347 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 15/200
604732/604732 - 30s - loss: 3.4039 - accuracy: 0.3591 - sparse_categorical_accuracy: 0.3591 - val_loss: 4.4228 - val_accuracy: 0.0361 - val_sparse_categorical_accuracy: 0.0361
Epoch 16/200
604732/604732 - 30s - loss: 3.4754 - accuracy: 0.3565 - sparse_categorical_accuracy: 0.3565 - val_loss: 3.8224 - val_accuracy: 0.3548 - val_sparse_categorical_accuracy: 0.3548
Epoch 17/200
604732/604732 - 30s - loss: 3.5401 - accuracy: 0.3577 - sparse_categorical_accuracy: 0.3577 - val_loss: 3.8024 - val_accuracy: 0.0683 - val_sparse_categorical_accuracy: 0.0683
Epoch 18/200
604732/604732 - 30s - loss: 3.5625 - accuracy: 0.3571 - sparse_categorical_accuracy: 0.3571 - val_loss: 4.3461 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 19/200
604732/604732 - 30s - loss: 3.5618 - accuracy: 0.3483 - sparse_categorical_accuracy: 0.3483 - val_loss: 3.1012 - val_accuracy: 0.3548 - val_sparse_categorical_accuracy: 0.3548
Epoch 20/200
604732/604732 - 30s - loss: 3.7116 - accuracy: 0.3467 - sparse_categorical_accuracy: 0.3467 - val_loss: 3.2660 - val_accuracy: 0.0681 - val_sparse_categorical_accuracy: 0.0681
Epoch 21/200
604732/604732 - 30s - loss: 3.5682 - accuracy: 0.3475 - sparse_categorical_accuracy: 0.3475 - val_loss: 1.7234 - val_accuracy: 0.4922 - val_sparse_categorical_accuracy: 0.4922
Epoch 22/200
604732/604732 - 30s - loss: 3.8002 - accuracy: 0.3461 - sparse_categorical_accuracy: 0.3461 - val_loss: 3.5108 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 23/200
604732/604732 - 30s - loss: 4.2961 - accuracy: 0.3369 - sparse_categorical_accuracy: 0.3369 - val_loss: 2.3492 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 24/200
604732/604732 - 30s - loss: 4.6640 - accuracy: 0.3298 - sparse_categorical_accuracy: 0.3298 - val_loss: 4.4972 - val_accuracy: 0.3548 - val_sparse_categorical_accuracy: 0.3548
Epoch 25/200
604732/604732 - 30s - loss: 4.7034 - accuracy: 0.3297 - sparse_categorical_accuracy: 0.3297 - val_loss: 6.5390 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00
Epoch 26/200
604732/604732 - 30s - loss: 4.5619 - accuracy: 0.3332 - sparse_categorical_accuracy: 0.3332 - val_loss: 7.1210 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00
Epoch 27/200
604732/604732 - 30s - loss: 4.2738 - accuracy: 0.3371 - sparse_categorical_accuracy: 0.3371 - val_loss: 5.9157 - val_accuracy: 0.0681 - val_sparse_categorical_accuracy: 0.0681
Epoch 28/200
604732/604732 - 30s - loss: 3.9051 - accuracy: 0.3434 - sparse_categorical_accuracy: 0.3434 - val_loss: 3.6875 - val_accuracy: 0.3548 - val_sparse_categorical_accuracy: 0.3548
Epoch 29/200
604732/604732 - 30s - loss: 3.9631 - accuracy: 0.3413 - sparse_categorical_accuracy: 0.3413 - val_loss: 5.4601 - val_accuracy: 0.0359 - val_sparse_categorical_accuracy: 0.0359
Epoch 30/200
604732/604732 - 30s - loss: 3.8820 - accuracy: 0.3440 - sparse_categorical_accuracy: 0.3440 - val_loss: 2.9915 - val_accuracy: 0.3548 - val_sparse_categorical_accuracy: 0.3548
Epoch 31/200
604732/604732 - 30s - loss: 3.8899 - accuracy: 0.3430 - sparse_categorical_accuracy: 0.3430 - val_loss: 3.6208 - val_accuracy: 0.0359 - val_sparse_categorical_accuracy: 0.0359
Epoch 32/200
604732/604732 - 30s - loss: 4.0648 - accuracy: 0.3378 - sparse_categorical_accuracy: 0.3378 - val_loss: 7.0949 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00
Epoch 33/200
604732/604732 - 30s - loss: 4.0059 - accuracy: 0.3401 - sparse_categorical_accuracy: 0.3401 - val_loss: 3.4627 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 34/200
604732/604732 - 30s - loss: 4.0323 - accuracy: 0.3412 - sparse_categorical_accuracy: 0.3412 - val_loss: 5.1067 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00
Epoch 35/200
604732/604732 - 30s - loss: 4.2056 - accuracy: 0.3385 - sparse_categorical_accuracy: 0.3385 - val_loss: 5.3997 - val_accuracy: 0.0332 - val_sparse_categorical_accuracy: 0.0332
Epoch 36/200
604732/604732 - 30s - loss: 4.2280 - accuracy: 0.3374 - sparse_categorical_accuracy: 0.3374 - val_loss: 5.1993 - val_accuracy: 0.0359 - val_sparse_categorical_accuracy: 0.0359
Epoch 37/200
604732/604732 - 30s - loss: 4.2416 - accuracy: 0.3366 - sparse_categorical_accuracy: 0.3366 - val_loss: 2.3610 - val_accuracy: 0.3548 - val_sparse_categorical_accuracy: 0.3548
Epoch 38/200
604732/604732 - 30s - loss: 4.4265 - accuracy: 0.3331 - sparse_categorical_accuracy: 0.3331 - val_loss: 6.8355 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 39/200
604732/604732 - 30s - loss: 4.5722 - accuracy: 0.3314 - sparse_categorical_accuracy: 0.3314 - val_loss: 3.7314 - val_accuracy: 0.0000e+00 - val_sparse_categorical_accuracy: 0.0000e+00
Epoch 40/200
604732/604732 - 30s - loss: 4.3637 - accuracy: 0.3362 - sparse_categorical_accuracy: 0.3362 - val_loss: 4.8380 - val_accuracy: 0.4923 - val_sparse_categorical_accuracy: 0.4923
Epoch 41/200
Restoring model weights from the end of the best epoch.
604732/604732 - 30s - loss: 4.5979 - accuracy: 0.3304 - sparse_categorical_accuracy: 0.3304 - val_loss: 4.5187 - val_accuracy: 0.0681 - val_sparse_categorical_accuracy: 0.0681
Epoch 00041: early stopping
09\_12\_21\_17\_16\_06\_classif\_batmen\_hnm2
mod_params= {'nb_conv_layers': 3, 'nb_dense_layers': 2, 'nb_filters': 48, 'filter_size': 3, 'pool_size': 2, 'nb_dense_nodes': 192, 'dropout_proba': 0.4, 'learn_rate_adam': 0.00011787686347935866, 'beta_1': 0.8, 'beta_2': 0.999, 'epsilon': 1e-08, 'min_delta': 0.005, 'patience': 20, 'batchsize': 320, 'win_size': 0.23, 'chunk_size': 0, 'max_freq': 270, 'min_freq': 10, 'mean_log_mag': 0.5, 'slice_scale': 0.02322, 'overlap': 0.75, 'crop_spec': True, 'denoise': True, 'smooth_spec': True, 'nms_win_size': 21, 'smooth_op_prediction_sigma': 1.0335917312661498, 'num_hnm': 2}
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
quant_conv2d (QuantConv2D)   (None, 130, 20, 48)       480       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 65, 10, 48)        0         
_________________________________________________________________
quant_conv2d_1 (QuantConv2D) (None, 65, 10, 48)        20784     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 32, 5, 48)         0         
_________________________________________________________________
quant_conv2d_2 (QuantConv2D) (None, 32, 5, 48)         20784     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 16, 2, 48)         0         
_________________________________________________________________
quant_conv2d_3 (QuantConv2D) (None, 16, 2, 48)         20784     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 8, 1, 48)          0         
_________________________________________________________________
dropout (Dropout)            (None, 8, 1, 48)          0         
_________________________________________________________________
flatten (Flatten)            (None, 384)               0         
_________________________________________________________________
quant_dense (QuantDense)     (None, 192)               73920     
_________________________________________________________________
dropout_1 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_1 (QuantDense)   (None, 192)               37056     
_________________________________________________________________
dropout_2 (Dropout)          (None, 192)               0         
_________________________________________________________________
quant_dense_2 (QuantDense)   (None, 8)                 1544      
=================================================================
Total params: 175,352
Trainable params: 175,352
Non-trainable params: 0
_________________________________________________________________
--------------
Confusion matrix detect + classif
--------------
[[1292135       0      14       0       0       0       0       0]
 [    109       0       0       0       0       0       0       0]
 [   1745       0       0       0       0       0       0       0]
 [   2120       0       0       0       0       0       0       0]
 [    482       0       0       0       0       0       0       0]
 [    882       0       0       0       0       0       0       0]
 [    171       0       0       0       0       0       0       0]
 [    396       0       0       0       0       0       0       0]]
--------------
Class 0 detect + classif
--------------
Accuracy 0.995440097253273
Precision 0.995450833564451
Recall 0.9999891653361958
F1 0.997714838569695
BCR 0.4999945826680979

--------------
Class 1 detect + classif
--------------
Accuracy 0.9999160281467488
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 2 detect + classif
--------------
Accuracy 0.9986448945883607
Precision 0.0
Recall 0.0
F1 nan
BCR 0.49999460005291946

--------------
Class 3 detect + classif
--------------
Accuracy 0.9983667859734648
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 4 detect + classif
--------------
Accuracy 0.9996286749241557
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 5 detect + classif
--------------
Accuracy 0.9993205213342434
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 6 detect + classif
--------------
Accuracy 0.9998682643403125
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
Class 7 detect + classif
--------------
Accuracy 0.9996949279459868
Precision nan
Recall 0.0
F1 nan
BCR 0.5

--------------
GLOBAL detect + classif
--------------
Average Accuracy 0.9988600243133182
Average Precision nan
Average Recall 0.12499864566702447
Average F1 nan
Average BCR 0.49999864784012715
KAPPA -1.3939732013733139e-05 \\
CEN 0.006636728447477057 \\
--------------
Confusion matrix detect
--------------
[[1292135      14]
 [   5905       0]]
--------------
Class 0 detect
--------------
Accuracy 0.995440097253273
Precision 0.995450833564451
Recall 0.9999891653361958
F1 0.997714838569695
BCR 0.4999945826680979

--------------
Class 1 detect
--------------
Accuracy 0.995440097253273
Precision 0.0
Recall 0.0
F1 nan
BCR 0.4999945826680979

--------------
GLOBAL detect
--------------
Average Accuracy 0.995440097253273
Average Precision 0.4977254167822255
Average Recall 0.4999945826680979
Average F1 nan
Average BCR 0.4999945826680979
KAPPA -2.1520193863587995e-05 \\
CEN 0.02011275733652385 \\
--------------
Confusion matrix classif
--------------
[[0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]
 [0 0 0 0 0 0 0]]
--------------
Class 1 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 2 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 3 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 4 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 5 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 6 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
Class 7 classif
--------------
Accuracy nan
Precision nan
Recall nan
F1 nan
BCR nan

--------------
GLOBAL classif
--------------
Average Accuracy nan
Average Precision nan
Average Recall nan
Average F1 nan
Average BCR nan
KAPPA nan \\
CEN nan \\
features computation time 1669.38 (secs) = 27.82 min \\
run time without features 5128.635 (secs) = 85.48 min \\
total run time 6798.014 (secs) = 113.3 min \\
2021-12-10 08:50:52.645518: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3800000000 Hz
2021-12-10 08:50:52.646919: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa7d15dee0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-12-10 08:50:52.646940: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-12-10 08:50:52.655502: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-12-10 08:50:53.317783: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa7d1229d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-12-10 08:50:53.317811: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 SUPER, Compute Capability 7.5
2021-12-10 08:50:53.318153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-10 08:50:53.319499: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-10 08:50:53.322001: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-10 08:50:53.330880: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-10 08:50:53.351087: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-10 08:50:53.358553: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-10 08:50:53.366960: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-10 08:50:53.376750: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-10 08:50:53.377143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-10 08:50:53.377181: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-10 08:50:53.377415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-10 08:50:53.377424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-10 08:50:53.377430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-10 08:50:53.377746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7472 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)

Model: batmen
test set detect: uk
test set classif: Natagora
Generate training positions
Train classifier
Compute or load features

Tune cls_cnn

 tune cnn
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:00<?, ?trial/s, best loss=?]                                                                                                                        CNN params= 
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:17<?, ?trial/s, best loss=?]                                                                                                                        {'nb_conv_layers': 1, 'nb_dense_layers': 3, 'nb_filters': 56, 'filter_size': 5, 'pool_size': 2, 'nb_dense_nodes': 320, 'dropout_proba': 0.3, 'learn_rate_adam': 4.393970560760786e-05, 'beta_1': 0.8, 'beta_2': 0.95, 'epsilon': 1e-08, 'min_delta': 0.0005, 'patience': 10, 'batchsize': 104}
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:17<?, ?trial/s, best loss=?]2021-12-10 08:55:34.339769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-10 08:55:34.357008: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-10 08:55:34.357094: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-10 08:55:34.357117: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-10 08:55:34.357126: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-10 08:55:34.357150: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-10 08:55:34.357159: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-10 08:55:34.357168: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-10 08:55:34.357529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-10 08:55:34.364059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: 
pciBusID: 0000:65:00.0 name: NVIDIA GeForce RTX 2080 SUPER computeCapability: 7.5
coreClock: 1.845GHz coreCount: 48 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 462.00GiB/s
2021-12-10 08:55:34.364091: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2
2021-12-10 08:55:34.364099: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-10 08:55:34.364106: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-12-10 08:55:34.364113: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-12-10 08:55:34.364120: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-12-10 08:55:34.364133: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-12-10 08:55:34.364140: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-12-10 08:55:34.364416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0
2021-12-10 08:55:34.364442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-10 08:55:34.364447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 
2021-12-10 08:55:34.364452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N 
2021-12-10 08:55:34.364739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7472 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 2080 SUPER, pci bus id: 0000:65:00.0, compute capability: 7.5)
                                                                                                                        Model: "sequential"
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Layer (type)                 Output Shape              Param #   
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d (QuantConv2D)   (None, 130, 20, 56)       1456      
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d (MaxPooling2D) (None, 65, 10, 56)        0         
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_conv2d_1 (QuantConv2D) (None, 65, 10, 56)        78456     
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        max_pooling2d_1 (MaxPooling2 (None, 32, 5, 56)         0         
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout (Dropout)            (None, 32, 5, 56)         0         
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        flatten (Flatten)            (None, 8960)              0         
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense (QuantDense)     (None, 320)               2867520   
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout_1 (Dropout)          (None, 320)               0         
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_1 (QuantDense)   (None, 320)               102720    
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout_2 (Dropout)          (None, 320)               0         
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_2 (QuantDense)   (None, 320)               102720    
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        dropout_3 (Dropout)          (None, 320)               0         
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        quant_dense_3 (QuantDense)   (None, 8)                 2568      
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        =================================================================
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Total params: 3,155,440
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Trainable params: 3,155,440
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        Non-trainable params: 0
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]                                                                                                                        _________________________________________________________________
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]/home/ndewinter/.local/lib/python3.6/site-packages/sklearn/utils/validation.py:72: FutureWarning: Pass classes=[0 1 2 3 4 5 6 7], y=[7 7 7 ... 3 3 3] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  "will result in an error", FutureWarning)

                                                                                                                        Fit the CNN
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:18<?, ?trial/s, best loss=?]2021-12-10 08:55:35.302127: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 2909088000 exceeds 10% of free system memory.
2021-12-10 08:55:36.557483: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 323232000 exceeds 10% of free system memory.
                                                                                                                        Train on 279720 samples, validate on 31080 samples
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:19<?, ?trial/s, best loss=?]                                                                                                                        Epoch 1/200
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:19<?, ?trial/s, best loss=?]2021-12-10 08:55:37.318796: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-12-10 08:55:37.524784: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
                                                                                                                        279720/279720 - 27s - loss: 15.7655 - accuracy: 0.3105 - sparse_categorical_accuracy: 0.3105 - val_loss: 11.4147 - val_accuracy: 0.4745 - val_sparse_categorical_accuracy: 0.4745

 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:46<?, ?trial/s, best loss=?]                                                                                                                        Epoch 2/200
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [00:46<?, ?trial/s, best loss=?]^CWARNING:tensorflow:Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss,accuracy,sparse_categorical_accuracy
 94%|██████████████████████████████████████████████████████████████████████▎    | 15/16 [01:01<?, ?trial/s, best loss=?]
Traceback (most recent call last):
  File "run_training.py", line 251, in <module>
    test_files_classif, test_pos_classif, test_durations_classif, test_classes_classif)
  File "/home/ndewinter/code/batML_main/batML_multiclass/classifier.py", line 90, in train
    self.model.train(positions, class_labels, files, durations)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cls_cnn.py", line 66, in train
    tune_network(self.params, features, labels, self.params.trials_filename_1)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 209, in tune_network
    best_space_indices = fmin(obj_func_cnn, space_cnn, trials=trials, algo=tpe.suggest, max_evals=max_trials)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 555, in fmin
    trials_save_file=trials_save_file,
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/base.py", line 688, in fmin
    trials_save_file=trials_save_file,
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 586, in fmin
    rval.exhaust()
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 364, in exhaust
    self.run(self.max_evals - n_done, block_until_done=self.asynchronous)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 300, in run
    self.serial_evaluate()
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/fmin.py", line 178, in serial_evaluate
    result = self.domain.evaluate(spec, ctrl)
  File "/home/ndewinter/.local/lib/python3.6/site-packages/hyperopt/base.py", line 892, in evaluate
    rval = self.fn(pyll_rval)
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 151, in obj_func_cnn
    _, history = network_fit(params_cnn, args['features'], args['labels'], args['nb_output'])
  File "/home/ndewinter/code/batML_main/batML_multiclass/cnn_helper.py", line 113, in network_fit
    validation_split=params.validation_split, callbacks=[callback])
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training.py", line 718, in fit
    use_multiprocessing=use_multiprocessing)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2.py", line 341, in fit
    total_epochs=epochs)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2.py", line 128, in run_one_epoch
    batch_outs = execution_function(iterator)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/keras/engine/training_v2_utils.py", line 98, in execution_function
    distributed_function(input_fn))
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py", line 576, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/def_function.py", line 607, in _call
    return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 2414, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 1660, in _filtered_call
    self.captured_inputs)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 1741, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager))
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/function.py", line 598, in call
    ctx=ctx)
  File "/usr/local/lib64/python3.6/site-packages/tensorflow/python/eager/execute.py", line 60, in quick_execute
    inputs, attrs, num_outputs)
KeyboardInterrupt
